\documentclass[10pt,a4paper,oneside,reqno]{amsart}

\usepackage{amsmath,geometry,amssymb,mathpartir,mathtools,latexsym,amsthm,enumerate,leftidx,tikz}

\usepackage[all]{xy}
\newcommand{\xycenter}[1]{\vcenter{\hbox{\xymatrix{#1}}}}
\SelectTips{cm}{}
\input{prooftree}

% Numberings 
\setcounter{tocdepth}{1}
\numberwithin{equation}{section}

% Table of contents
\makeatletter
\def\@tocline#1#2#3#4#5#6#7{\relax
\ifnum #1>\c@tocdepth % then omit
  \else 
    \par \addpenalty\@secpenalty\addvspace{#2}% 
\begingroup \hyphenpenalty\@M
    \@ifempty{#4}{%
      \@tempdima\csname r@tocindent\number#1\endcsname\relax
 }{%
   \@tempdima#4\relax
 }%
 \parindent\z@ \leftskip#3\relax \advance\leftskip\@tempdima\relax
 \rightskip\@pnumwidth plus4em \parfillskip-\@pnumwidth
 #5\leavevmode\hskip-\@tempdima #6\nobreak\relax
 \ifnum#1<0\hfill\else\dotfill\fi\hbox to\@pnumwidth{\@tocpagenum{#7}}\par
 \nobreak
 \endgroup
  \fi}
\makeatother

\def\noqed{\renewcommand{\qedsymbol}{}}

% Theorems

\newtheoremstyle{mythm}% 
{10pt}% Space above 
{}% Space below 
{\itshape}% Body font 
{}% Indent amount 
{\bfseries}%  Theorem head font 
{.}% Punctuation after theorem head 
{.5em}% Space after theorem head 
{}% 

\newtheoremstyle{mydef}% 
{10pt}% Space above 
{3pt}% Space below 
{}% Body font 
{}% Indent amount 
{\bfseries}%  Theorem head font 
{.}% Punctuation after theorem head 
{.5em}% Space after theorem head 
{}% 

\newtheoremstyle{myrmk}% 
{10pt}% Space above 
{3pt}% Space below 
{}% Body font 
{}% Indent amount 
{\itshape}%  Theorem head font 
{.}% Punctuation after theorem head 
{.5em}% Space after theorem head 
{}% 

\theoremstyle{mythm}
\newtheorem{theorem}{Theorem}[subsection]
\newtheorem*{theorem*}{Theorem}
\newtheorem{lemma}[theorem]{Lemma} 
\newtheorem{proposition}[theorem]{Proposition} 
\newtheorem{corollary}[theorem]{Corollary}  
\newtheorem{apptheorem}{Theorem}
\newtheorem{atheorem}{Theorem}
\renewcommand*{\theatheorem}{\Alph{atheorem}}
\theoremstyle{mydef}
\newtheorem{definition}[theorem]{Definition}	
\newtheorem*{definition*}{Definition}	
\theoremstyle{myrmk}
\newtheorem{remark}[theorem]{Remark} 
\newtheorem{remarks}[theorem]{Remarks} 
\newtheorem*{remark*}{Remark} 
\newtheorem*{remarks*}{Remarks} 
\newtheorem{example}[theorem]{Example}
\newtheorem{examples}[theorem]{Examples}
\newtheorem*{example*}{Example}
\newtheorem*{examples*}{Examples}

% Text commands
\newcommand{\ie}{\text{i.e.\ }}
\newcommand{\eg}{\text{e.g.}}
\newcommand{\resp}{\text{resp.\ }}
\newcommand{\myemph}[1]{\textit{#1}}
\newcommand{\by}[1]{\quad&&\text{by {$#1$}}}

% Judgemental equality, path equality, homotopy, definitions
\newcommand{\deq}{=}
\newcommand{\peq}{\Rightarrow}
\newcommand{\ho}{\sim}
\newcommand{\defeq}{=_{\mathrm{def}}}
\newcommand{\co}{\,{:}\,}
\newcommand{\type}{\mathsf{type}}
\newcommand{\com}{\circ}
\newcommand{\iso}{\cong}

% Composition and identiies
\newcommand{\idfun}[1]{\mathsf{id}_{#1}}
% \newcommand{\comp}{\circ}
\newcommand{\ct}{\cdot}

% Names for type theories
\newcommand{\Hint}{\mathcal{H}}
\newcommand{\Hext}{\mathcal{H}_{\mathrm{ext}}}
\newcommand{\UA}{\mathrm{UA}}

% General notions

\newcommand{\hfiber}{\mathsf{hfiber}}
\newcommand{\iscontr}{\mathsf{iscontr}}
\newcommand{\isntype}[1]{\mathsf{is}\text{-}\mathsf{#1}\text{-}\mathsf{type}}
\newcommand{\isprop}{\mathsf{isprop}}
\newcommand{\isequiv}{\mathsf{isequiv}}
\newcommand{\isind}{\mathsf{isind}}
\newcommand{\isbipind}{\mathsf{isind}}
\newcommand{\isalgind}{\mathsf{isind}}
\newcommand{\ishinit}{\mathsf{ishinit}}
\newcommand{\isbiphinit}{\mathsf{ishinit}}
\newcommand{\isalghinit}{\mathsf{ishinit}}
\newcommand{\trans}{\mathsf{tr}}
\newcommand{\Hot}{\mathsf{Hot}}
\newcommand{\Eq}{\mathsf{Equiv}}

% Extensionality

\newcommand{\ext}{\mathsf{ext}}
\renewcommand{\int}{\mathsf{int}}
\newcommand{\idtodpair}{\ext}
\newcommand{\happly}{\exti}
\newcommand{\funext}{\int}       
\newcommand{\idtoeq}{\ext}

% Bool

\newcommand{\Bool}{\mathsf{Bool}}
\newcommand{\true}{1}
\newcommand{\false}{0}
\newcommand{\one}{\mathsf{1}}
\newcommand{\zero}{\mathsf{0}}
\newcommand{\boolind}{\mathsf{boolelim}}
\newcommand{\boolrec}{\mathsf{boolrec}}

% Nat

\newcommand{\nat}{\ensuremath{\mathbb{N}}} 
\newcommand{\suc}{\mathsf{suc}}

% Id-types

\newcommand{\Id}{\mathsf{Id}}
\newcommand{\id}[1]{\Id_{#1}}
\newcommand{\refl}{\mathsf{refl}}
\newcommand{\idrec}{\mathsf{J}}

% Pi-types

\newcommand{\prd}[1]{\Pi_{#1}}
\newcommand{\lam}[1]{\lambda_{#1}}   
\newcommand{\app}{\mathsf{app}}

% Sigma-types

\newcommand{\sm}[1]{\Sigma_{#1}}    
\newcommand{\pair}{\mathsf{pair}}
\newcommand{\mysplit}{\mathsf{split}}
\newcommand{\fst}{\mathsf{fst}}
\newcommand{\snd}{\mathsf{snd}}

% W-types

\newcommand{\W}{\mathrm{W}}
\newcommand{\wsup}{\mathsf{sup}}
\newcommand{\wrec}{\mathsf{wrec}}
\newcommand{\wind}{\mathsf{elim}}
\newcommand{\wcomp}{\mathsf{wcomp}}

% Universes

\newcommand{\U}{\mathsf{U}}

% Bipointed types

\newcommand{\ind}{\mathsf{ind}}
\newcommand{\Hom}{\mathsf{Hom}}
\newcommand{\Bip}{\mathsf{Bip}}
\newcommand{\BipHom}{\mathsf{Bip}}
\newcommand{\BipHot}{\mathsf{BipHot}}
\newcommand{\FibBip}{\mathsf{FibBip}}
\newcommand{\BipSec}{\mathsf{BipSec}}
\newcommand{\isbipequiv}{\mathsf{isbipequiv}}
\newcommand{\BipEquiv}{\mathsf{BipEquiv}}
\newcommand{\HoSec}{\mathsf{BipSecHo}}
\newcommand{\elim}{\mathsf{elim}}
\newcommand{\comp}{\mathsf{comp}}
\newcommand{\rec}{\mathsf{rec}}
\newcommand{\Tot}{\mathsf{Tot}}

% P-algebras

\newcommand{\Palg}{\mathsf{Alg}}
\renewcommand{\sup}{\mathrm{sup}}
\newcommand{\isalgequiv}{\mathsf{isalgequiv}}
\newcommand{\AlgEquiv}{\mathsf{AlgEquiv}}
\newcommand{\AlgHot}{\mathsf{AlgHot}}
\newcommand{\FibAlgHot}{\mathsf{FibAlgHot}}
\newcommand{\FibPalg}{\mathsf{FibAlg}}
\newcommand{\PalgSec}{\mathsf{AlgSec}}
\newcommand{\AlgSecHot}{\mathsf{AlgSecHot}}



% DOCUMENT 

\begin{document}

\title[]{Homotopy-initial algebras in type theory}
\author[S. Awodey]{STEVE AWODEY}
\address{Steve Awodey, Department of Philosophy 
Carnegie Mellon University 
Pittsburgh, PA  15213, USA}
\email{awodey@cmu.edu}
\author[N. Gambino]{NICOLA GAMBINO}
\address{Nicola Gambino, School of Mathematics, University of Leeds, Leeds LS2 9JT, UK}
\email{n.gambino@leeds.ac.uk}
\author[K. Sojakova]{KRISTINA SOJAKOVA}
\address{Kristina Sojakova, Department of Computer Science, Carnegie Mellon University, Pittsburgh, PA 15213, USA}
\email{kristinas@cmu.edu}
\date{\today}



\begin{abstract}
Homotopy type theory is an interpretation of Martin-L\"of's constructive type theory into abstract homotopy theory.   There results a link between constructive mathematics and algebraic topology, providing topological semantics for intensional systems of type theory as well as a computational approach to algebraic topology via type theory-based proof assistants such as~Coq.

The present work investigates inductive types in this setting. Modified rules for inductive types, including types of well-founded trees, or W-types, are presented, and the basic homotopical semantics of such types are determined.  Proofs of all results have been formally verified by the Coq proof assistant, and the proof scripts for this verification form an essential component of this research.      
\end{abstract}


\maketitle



\begin{small}
\tableofcontents
\end{small}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}

The general topic of Homotopy Type Theory is concerned with the study of the constructive type theories of Martin-L\"of under their new interpretation into abstract homotopy theory and higher-dimensional category theory. Martin-L\"of type theories are foundational systems which have been used to formalize large parts of constructive mathematics, and also for the development of high-level programming languages~\cite{MartinLofP:conmcp}.  They are prized for their combination of expressive strength and desirable proof-theoretic properties.  One aspect of these type theories that has led to special difficulties in providing semantics is the intensional character of equality.  In recent work \cite{AwodeyS:homtmi,VoevodskyV:notts,vandenBergB:topsmi,AwodeyS:typth}, it has emerged that the topological notion of \emph{homotopy} provides an adequate basis for the semantics of intensionality.  This extends the paradigm of computability as continuity, familiar from domain theory, beyond the simply-typed 
$\lambda$-calculus to dependently-typed theories involving:\begin{enumerate}[(i)]
\item dependent sums $(\Sigma x\colon\!{A})B(x)$ and dependent products $(\Pi x\colon\!{A})B(x)$, modelled respectively by the total space and the space of sections of the fibration modelling the dependency of $B(x)$ over $ x \co A$; \item
and, crucially, including the identity type constructor~$\Id(a,b)$, interpreted as the space of all \emph{paths} in~$A$ between points~$a$ and~$b$. \end{enumerate}

In the present work, we build on this homotopical interpretation to study inductive types, such as the natural numbers, Booleans, lists, and W-types. Within extensional type theories, W-types can be used to  provide a constructive counterpart of the classical notion of a well-ordering~\cite{MartinLofP:inttt} and to uniformly define a variety of inductive types~\cite{DybjerP:repids}.
However, most programming languages and proof assistants, such as Coq~\cite{BertotY:inttpp}, Agda~\cite{NorellU:towppl} and Epigram~\cite{McBrideC:viefl} use schematic inductive definitions~\cite{CoquandT:inddt,PaulinMorhringC:inddsc} rather than W-types to define inductive types.  This is due in part to the practical convenience of the schematic approach, but it is also a matter of necessity; these systems are based on intensional rather than extensional type theories, and in the intensional theory the usual reductions of inductive types to W-types fail~\cite{DybjerP:repids,McBrideC:wtygnb}.
Nonetheless, W-types retain great importance from a theoretical perspective, since they allow us to internalize in type theory arguments about inductive types. Furthermore, a limited form of extensionality licensed by the homotopical interpretation suffices to develop the theory of W-types in a satisfactory way. In particular, we shall make use of ideas from higher category theory and homotopy theory to understand W-types as ``homotopy-initial" algebras of an appropriate kind.

In intensional type theories, inductive types cannot be characterized by standard category-theoretic
universal properties. For instance, in this setting it is not possible to show that there exists a 
definitionally-unique function out of the empty type with rules as in~\cite[Section~5.2]{NordstromB:marltt}, thus making it impossible to prove that the empty type provides an initial object. 
Another consequence of this fact is that, if we attempt to define the type of 
natural numbers as a W-type in the usual way, then 
the usual elimination and computation rules for it are no longer derivable~\cite{DybjerP:repids}. Similarly, it is not possible to show the uniqueness of recursively-defined functions out of W-types. When interpreted categorically, the uniqueness of such functions translates into the initiality property of the associated polynomial functor algebra, which is why the correspondence between W-types and initial algebras fails in the intensional setting.

Due to this sort of poor behaviour of W-types, and other constructions, in the purely intensional setting, that system is often augmented by other extensionality principles that are somewhat weaker than the Reflection rule, such as Streicher's K-rule  or the Uniqueness of Identity Proofs (UIP)~\cite{StreicherT:invitt}, which has recently been reconsidered
in the context of Observational Type Theory \cite{AltenkirchT:obsen}.  Inductive types in such intermediate systems are somewhat better behaved, but still exhibit some undesirable properties, making them less useful for practical purposes than one might wish~\cite{McBrideC:wtygnb}.  Moreover, these intermediate systems seem to lack a clear conceptual basis:  they neither intend to formalize constructive sets (like the extensional theory) nor is there a principled reason to choose these particular extensionality rules, beyond their practical advantages.  


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Homotopy-theoretic concepts in type theory}
\label{sec:bac}


\subsection{Review of type theory.} We begin by introducing a very simple  Martin-L\"of type 
theory, denoted by~$\mathcal{M}$, which provides the basis for the type theory $\Hint$, introduced later,
with which will work in the paper.
Our type theories will be formulated using the four standard forms of judgement
\[
A \co \type \, , \quad A \deq B \co \type \, , \quad   a \co A \, , \quad a \deq b \co A \, . 
\]
We refer to the equality relation in these judgements as \emph{judgemental equality}, 
which should be contrasted with the notion of \emph{propositional equality}
defined below. 
Each kind of judgement can also be made relative to a context of variable declarations $\Gamma$, e.g. $\Gamma \vdash A \co \type$, etc... However, when stating deduction rules we may omit the mention
of a context common to premisses and conclusions of the rule, and we
make use of other standard conventions to simplify the exposition. The type theory $\mathcal{M}$ has
rules for the following forms of type:
\[
(\Sigma x \co A) B(x) \, , \quad 
(\Pi x \co A) B(x) \, , \quad
 \Id_A(a,b) \,  ,  \quad
 \U \, . 
 \]
The rules for these types are recalled in 
Tables~\ref{tab:sigmarules},~\ref{tab:pirules},~\ref{tab:idrules} and~\ref{tab:urules}, respectively. The rules
are as in~\cite{NordstromB:marltt}, except that the rules for the type universe $\U$ are stated 
in the so-called Russell-style for simplicity. Neither the type theory $\mathcal{M}$ nor the type theory $\Hint$ which we 
introduce below have any ground types. This is because these type theories are intended as background
theories for our study of inductive types. 



\begin{table}[htb]
\fbox{\begin{minipage}{14cm}
\[
\begin{prooftree}
x \co A \vdash B(x) \co \type
\justifies
\textstyle
(\Sigma x \co A) B(x) \co \type
\end{prooftree}
\qquad \qquad
\begin{prooftree}
a \co A \qquad 
b(a) \co B(a) 
\justifies
\textstyle
\pair(a,b) \co (\Sigma x \co A) B(x)
\end{prooftree}
\]  \bigskip
\[
\begin{prooftree}
\textstyle
u \co (\Sigma x \co A) B(x) \vdash E(u) \co \type \quad
 x \co A, y \co B(x) \vdash  e(x,y) \co  E(\pair(x,y))  
\justifies
\textstyle
u \co (\Sigma x \co A) B(x) \vdash  \mysplit(u,e) \co  E(u)
\end{prooftree}
\]  \bigskip
\[
\begin{prooftree}
\textstyle
u \co (\Sigma x \co A) B(x) \vdash E(u) \co  \type \quad
 x \co  A, y \co B(x) \vdash  e(x,y) \co  E(\pair(x,y))  
 \justifies
x \co A, y \co B(x) \vdash \mysplit(\pair(x,y),e) = e(x,y) \co  E(\pair(x,y)) \, .
\end{prooftree} \medskip
\]
\end{minipage}} \smallskip
\caption{Rules for $\Sigma$-types.}
\label{tab:sigmarules} 
\end{table}

\begin{table}[htb]
\fbox{
\begin{minipage}{14cm}
\[
\begin{prooftree}
x \co A \vdash B(x) \co \type
\justifies
\textstyle
(\Pi x \co A) B(x) \co \type
\end{prooftree} \qquad \qquad
\begin{prooftree}
x \co A \vdash b(x) \co B(x) 
\justifies
\textstyle
(\lambda x \co A)b(x) \co (\Pi x \co A)B(x)
\end{prooftree}
\] \medskip 
\[
\begin{prooftree}
\textstyle
f \co (\Pi x \co A) B(x) \quad
a \co A 
\justifies
\app(f, a) \co B(a)
\end{prooftree} \qquad \qquad
\begin{prooftree}
x \co A \vdash b(x) \co B(x) 
\justifies
\app( (\lambda x \co A) b(x), a) = b(a) \co B(a)
\end{prooftree} \medskip 
\]
\end{minipage}} \medskip
\caption{Rules for $\Pi$-types.}
\label{tab:pirules}

 \end{table}
 

\begin{table}[htb]
\fbox{
\begin{minipage}{14cm}
\[
\begin{prooftree}
A \co  \type \quad 
a \co  A  \quad
b \co  A 
\justifies
 \id{A}(a,b) \co  \type
 \end{prooftree} \qquad \qquad 
\begin{prooftree}
a \co A 
\justifies
 \refl(a) \co  \id{A}(a,a)
 \end{prooftree} 
\] \bigskip
\[
\begin{prooftree}
x, y \co A, u \co  \id{A}(x,y) \vdash E(x,y,u) \co \type \qquad
 x \co A \vdash  e(x) \co  E(x,x,\refl(x))  
\justifies
x, y \co A, u \co  \id{A}(x,y) \vdash  \idrec(x,y,u,e) \co E(x,y,u)
\end{prooftree}
\] \bigskip
\[
\begin{prooftree}
x, y \co  A, u \co  \id{A}(x,y) \vdash E(x,y,u) \co \type \qquad
 x \co  A \vdash  e(x) \co  E(x,x,\refl(x)) 
 \justifies
x \co A \vdash \idrec(x,x,\refl(x), e) = e(x) \co  E(x, x, \refl(x)) \, .
\end{prooftree}
\] \smallskip
\end{minipage}} \smallskip
\caption{Rules for $\Id$-types.} 
\label{tab:idrules}
\end{table}


\begin{table}
\fbox{
\begin{minipage}{14cm}
\[
\begin{prooftree}
A \co \U \quad
x \co A \vdash B(x) \co \U 
\justifies
(\Sigma x \co A) B(x) \co \U
\end{prooftree} \qquad
\begin{prooftree}
A \co \U \quad
x \co A \vdash B(x) \co \U 
\justifies
(\Pi x \co A) B(x) \co \U
\end{prooftree}  
\]
\medskip
\[
\begin{prooftree}
A \co \U \quad
a \co A \quad
b \co A 
\justifies
\Id_A(a,b) \co \U
\end{prooftree}  \qquad
\begin{prooftree}
A \co \U 
\justifies
A \co \type
\end{prooftree}
\]
\smallskip
\end{minipage}} \smallskip 
\caption{Rules for the type universe $\U$.}
\label{tab:urules}
\end{table}

Let us establish some notation and recall some
basic facts and  terminogy. First of all, for~$f \co (\Pi x \co A) B(x)$ and $a \co A$, we write~$f(a)$ or~$f  a$ instead of $\app(f,a)$. Given types $A$ and~$B$, the product type $A \times B$ and the function $A \rightarrow B$  are defined via $\Sigma$-types and $\Pi$-types in the usual way.  The rules for $\Sigma$-types allow us to derive the rules for projections

\[
\begin{prooftree}
c \co (\Sigma x \co A)B(x) 
\justifies
\pi_1(c) \co A 
\end{prooftree} \qquad
\begin{prooftree}
c \co (\Sigma x \co A)B(x) 
\justifies
\pi_2(c) \co B(\pi_1(c))
\end{prooftree} \medskip
\]
We say that two elements  $a, b \co A$ are \emph{propositionally equal} if  the type $\Id_A(a,b)$ is inhabited and
write  $a \iso b$ to denote this situation. 


The rules for $\Sigma$-types allow us to prove the following propositional form of the $\eta$-rule for $\Sigma$-types:
\begin{equation}
\label{equ:etasigma}
\begin{prooftree}
c \co (\Sigma x \co A) B(x)
\justifies
\eta_c \co \Id( c, \pair(\pi_1(c), \pi_2(c))
\end{prooftree}
\end{equation}
This rule asserts that every element of a $\Sigma$-type is propositionally equal to one of canonical form.
Note that neither $\mathcal{M}$ nor $\Hint$ include the judgemental form of the $\eta$-rules for $\Sigma$-types, 
as is done in~\cite{GoguenH:inddtw}. 

The presence of the type universe $\U$ allows us to define a notion of a small type:
as usual, we say that a type  $A$ is \emph{small} if it is an element of  the universe, \ie $A\co\U$. 



 
 \subsection{The type theory $\Hint$}
The type theory $\Hint$ which will serve as the background theory for our development extends the type
theory $\mathcal{M}$ described above with two additional rules. The first additional rule is a judgemental form of the 
$\eta$-rule for $\Pi$-types:
\begin{equation}
\label{equ:etapi}
\begin{prooftree}
\textstyle
f \co (\Pi x \co A) B(x) 
\justifies
\textstyle
f = (\lambda x \co A) \app(f, x) \co  (\Pi x \co A)B(x)
\end{prooftree} 
\end{equation}
The second additional rule is what we call the Function Extensionality principle, 
which is considered here with propositional equalities:
 \begin{equation}
 \label{equ:funext}
 \begin{prooftree} 
 f \co (\Pi x \co A)B(x) \qquad
 g \co (\Pi x \co A) B(x) \qquad
 x \co A \vdash \alpha(x) \co \Id_{B(x)}(f(x), g(x))
 \justifies
 \mathsf{funext}(f, g, \alpha) \co \Id_{(\Pi x \co A)B(x)}(f,g) \, .
 \end{prooftree}
\end{equation}
 
\medskip






The particular choice of rules for $\Hint$ implies that this theory has a both set-theoretic
models and a homotopy-theoretic ones.  In particular, $\Hint$ 
does not include any global extensionality rules, like the identity reflection rule, the K rule, or 
the Uniqueness of Identity Proofs principle~\cite{StreicherT:invitt}. This makes $\Hint$ it possible
for $\Hint$ to have not only straightforward set-theoretic models (where those extensionality
principles are valid) but also with homotopy-theoretic models, such as the groupoid model~\cite{HofmannM:gromtt}, in which the rules of $\Hint$, but not the extensionality principles mentioned above, remain valid. Indeed, $\Hint$ is a subsystem of the type theory 
used in Voevodsky's Univalent Foundations of Mathematics programme~\cite{VoevodskyV:unifc}. 
In particular, the 
Function Extensionality axiom in~\eqref{equ:funext} is formally implied by Voevodsky's Univalence axiom~\cite{VoevodskyV:notts} (using the fact, also shown in~\cite{VoevodskyV:notts}, that Function Extensionality, as stated in~\eqref{equ:funext}, follows from its special case for function types). But, in contrast with the Univalence
Axiom, the Function Extensionality axiom is valid also in set-theoretic models. 


\begin{remark*} Our results continue to hold when the judgemental $\eta$-rule for $\Pi$-types in~\eqref{equ:etapi}
is weakened by replacing the judgemental equality in its conclusion with a propositional one. However, since the
current version of the Coq proof assistant assumes the rule~\eqref{equ:etapi} and some of the proofs can be 
simplified in its presence, we prefer to work with it in order to keep our presentation simpler and 
more faithful to the formalization.
\end{remark*}


 We write $\Hext$ for the extensional type
theory obtained from $\Hint$ by adding the following rule, known as the identity reflection rule:
\begin{equation}
\label{equ:collapse}
\begin{prooftree}
 p \co  \Id_A(a,b)
  \justifies
  a=b \co  A \, . 
  \end{prooftree} \medskip
\end{equation}
This rule collapses propositional equality to definitional equality, thus making the overall system
somewhat simpler to work with. However, it destroys part of the constructive character of the intensional system, since it makes type-checking undecidable~\cite{HofmannM:extcit}. For this reason, it is not assumed
in the most recent formulations of Martin-L\"of type theories~\cite{NordstromB:marltt} or in automated proof assistants like Coq~\cite{BertotY:inttpp}. However, most work on inductive types to date (\eg~\cite{AbbottM:concsp,DybjerP:repids,GambinoN:weltdp,MoerdijkI:weltc}) has been in the setting of extensional type theories.




\subsection{Homotopy-theoretic notions in type theory} For the convenience of the reader, 
we review some notions and basic facts from~\cite{HoTT,VoevodskyV:notts}. First of all, recall that for a dependent type
\begin{equation}
\label{equ:dependenttype}
x\co A \vdash E(x) \co \type \, ,
\end{equation} 
and a path $p\co \Id_A(a,b)$, we have the \emph{transport functions} 
\[
p_{\, ! } \co E(a) \rightarrow E(b) \, , \quad p^* \co E(b) \to E(a) \, .
\] 
These are defined by $\Id$-elimination so that, for $x \co A$ the functions $\refl(x)_{\, !} \co B(x) \rightarrow B(x)$ 
and~$\refl(x)^* \co B(x) \to B(x)$ are the identity function $1_{B(x)} \co B(x) \to B(x)$.  In order to emphasize the 
that dependent types are interpreted as fibrations in homotopy-theoretic models, we sometimes refer to a dependent
type as in~\eqref{equ:dependenttype} as a \emph{fibered type} over $A$. Correspondingly, we sometimes call
the type $(\Sigma x \co A)E(x)$ as the \emph{total type} of the fibered type. Similarly, elements of the 
type~$(\Pi x \co A)E(x)$~will be sometimes called \emph{sections} of the fibered type. This terminology is supported by the fact that a section $f \co (\Pi x \co A)E(x)$ determines a function $f' \co A \to (\Sigma x \co A)E(x)$, defined by
$f' \defeq (\lambda x \co A) \pair(x, fx)$, such that $ \pi_1 f'(x) = x$ for every $x \co A$.  We represent such a situation in the diagram
  \[
   \xymatrix{
    (\Sigma x \co A) E(x) \ar[d]_{\pi_1} \\
    \;  A \, . \ar@/_2pc/[u]_{f'} }
     \]

Let us recall the notions of an equivalence. In order to do this, we need some auxiliary notions. Recall that a type $A$ is said to be \emph{contractible} if the  type 
 \begin{equation}
 \label{eq:contractible}
\iscontr(A) \defeq (\Sigma x\co A) (\Pi y\co A) \Id(x,y)
\end{equation}
is inhabited. The type $\iscontr(A)$ can be seen as the propositions-as-types translation
of the formula stating that $A$ has a unique element. However, its homotopical interpretation 
is as a space that is inhabited if and only if the space interpreting $A$ is contractible in the usual
topological sense. Next, we define the \emph{homotopy fiber} of a function $f \co A \to B$ over $y \co B$ as the type
\[
 \hfiber(f,y) \defeq (\Sigma x \co A)\, \Id(f x, y) \, .
\]
A function $f \co A \to B$ is then  said to be an \emph{equivalence} if and only if all of its homotopy fibers are contractible, \ie the type
\[
\isequiv(f) \defeq (\Pi y \co B) \, \iscontr(\hfiber(f,y)) 
\]
is inhabited.  For types $A$ and $B$, the type $\Eq(A,B)$ of equivalences from $A$ to $B$ is  defined so that its canonical elements are pairs consisting of a function $f \co A \to B$ and a proof that it is an equivalence, \ie we let 
 \begin{equation}
 \label{equ:weq}
 \Eq(A,B) \defeq (\Sigma f \co A \to B) \, \isequiv(f) \, .
 \end{equation}
 We write $A\simeq B$ if there is an equivalence from $A$ to $B$. For example, the well-known $\Pi\Sigma$-distributivity, which is sometimes referred to as the type-theoretic axiom of choice, can be expressed as an equivalence 
 \begin{equation}
 \label{equ:ac}
 (\Pi x \co A)(\Sigma y \co B(x)) E(x,y) \simeq 
 (\Sigma u  \co (\Pi x \co A)B(x)) (\Pi x \co A) E(x, ux) \, .
 \end{equation}
 It can be shown that a function $f \co A \rightarrow B$ is an equivalence if and only if it has a two-sided inverse,
 \ie there exists a function $g \co B \to A$ such that the types $\Id(gf, 1_A)$
 and $\Id(fh, 1_B)$ are inhabited. However, the type of equivalences is not equivalent to
 the type of functions with a two-sided inverse as above, but instead (as originally suggested by Andr\'e Joyal) 
to the type of functions that have a left inverse and a right inverse, \ie functions
$g \co B \to A$ and $h \co B \to A$ such that the  types $ \Id(g  f, 1_A)$ and $\Id(f h, 1_B)$ are inhabited. 
More precisely, for every $f \co A \to B$, there is an equivalence
\[
\isequiv(f) \simeq 
 \big( 
 (\Sigma g \co B \to A) \Id(gf, 1_A) \times (\Sigma h \co B \to A) \Id(fh, 1_B) 
 \big) \, .
 \]
For our purposes, the idea of equivalences as functions with a left and a right inverse will be most
easily generalized when we consider types equipped with additional structure.

As we will see below, identity types of function types admit an equivalent description.  For $f \, , g \co (\Pi x \co A) B(x)$, the type of homotopies between $f$ and $g$ 
is defined by letting
\[
\Hot(f,g) \defeq (\Pi x:A) \Id_{B(x)}(fx,gx) \, .
\]
We sometimes write  $\alpha \co f \sim g$ rather than $\alpha \co \Hot(f,g)$. As we will see below, thanks to the
principle of function extensionality, homotopies are essentially the same thing as 

Finally, let us recall that the notion of contractibility introduced earlier can be used to articulate the world of types  
into a hierarchy of so-called \emph{h-levels} according to their homotopical complexity. We will make use only the notion of a type of h-level 1, or mere proposition. By definition, a type $A$ is said to be a \emph{mere proposition} if the type
\[
\isprop(A) \defeq (\Pi x \co A)(\Pi  y \co A) \, \iscontr( \Id(x,y)) 
\]
is inhabited.


\subsection{Characterization of identity types} \label{sec:chait} We now recall that the identity types of various kinds of 
types, such as product types and function types, admit an equivalent description. First of all, observe that 
for $A$ and $B$ be two types. For any 
pair of elements $c, d  \co A \times B$, and $f, g \co A \to B$, we have  canonical maps
\begin{align*} 
\ext^{\times}_{c,d}  \co & \Id_{A \times B}(c, d) \to \Id_{A}(\pi_1 c, \pi_1 d) \times \Id_{B}(\pi_2 c, \pi_2 d) \, , \\
\ext^{\to}_{f,g} \co & \Id_{A \to B}(f, g) \to (\Pi x \co A) \Id_B(fx, gx) \, ,
\intertext{These functions can be easily generalized to $\Sigma$-types and $\Pi$-types, so as to obtain functions}
\ext^\Sigma_{c,d} \co &  \Id_{(\Sigma x \co A)B(x)}(c, d) \to (\Sigma p \co \Id(c_1, d_1)) \,  \Id( p_{!}(c_2), d_2) \, , \\ 
\ext^\Pi_{f,g} \co & \Id_{(\Pi x \co A)B(x)}(f, g) \to (\Pi x \co A) \Id_{B(x)}(f x, gx)  \, . \\ 
\intertext{Furthermore, for the type universe $\U$, we have a function}
\ext^\U_{A,B} \co & \Id_\U(A,B) \to \Eq(A,B) \, .
\end{align*}
We refer to these functions as the \emph{extension functions} for product types, function types, $\Sigma$-types,
$\Pi$-types and $\U$, respectively.  We then have that extension functions for product types and $\Sigma$-types 
can be shown to be equivalences within the type theory~$\mathcal{M}$, using the (provable) $\eta$-rule for $\Sigma$-types.
The extension functions for function types and $\Pi$-types, instead,  can be shown to be equivalences within the type theory $\Hint$, using the Function Extensionality principle that is part of it. Finally, the assertion that the extension function is 
exactly the  Univalence Axiom. Thus, within the type theory $\Hint$ we have families of equivalences
\begin{align*}
\Id_{A \times B}(c,d) & \simeq \Id_A(\pi_1 c \, , \pi_1 d) \times \Id_B(\pi_2 c,\pi_2 d) \\
\Id_{A \to B}(f, g) & \simeq (\Pi x \co A) \Id_B (fx, gx)  \, , \\
\Id_{(\Sigma x \co A)B(x)}(c, d) &  \simeq    (\Sigma p \co \Id_A( \pi_1 c, \pi_1 d )) \Id_{B(\pi_2 c)}( p_{!} \pi_2 c, 
\pi_2 d) \, ,   \\
 \Id_{(\Pi x \co A)B(x)}(f, g)  & \simeq   (\Pi x \co A) \Id_{B(x)}(f x, gx)   \, ,\\ 
 \intertext{and, in the extension of $\Hint$ with the Univalence Axiom, also equivalences}  
\Id_\U(A, B) & \simeq   \Eq(A, B)   \, . 
 \end{align*}
In the following, we shall always omit  superscripts and subscripts when manipulating these functions,
as the context makes it clear which one we are referring to. 

\subsection{Higher-dimensional categorical structure} Even if our development is entirely syntactic,
many of the ideas presented in the paper are inspired by concepts of homotopy theory and higher-dimensional
algebra. Therefore, in order to provide
some insight into our development, we discuss informally some aspects of the relationship with higher-dimensional category theory. 

 First of all, observe that types and functions can be organized into an ordinary 
 category, where the composition and identity laws hold as judgemental equalities. Indeed, if we define the composite $g \circ f \co A 
\to C$ of $f \co A \to B$ and $g \co B \to C$ by letting
\[
 g \circ f \defeq (\lambda x \co A) g ( f  x) \, ,
 \]
 and the identity $1_A \co A \to A$ by letting $1_A \defeq (\lambda x \co A) x$, 
 the presence of the judgemental $\eta$-rule for $\Pi$-types in~\eqref{equ:etapi} in $\Hint$ implies that
 we have judgemental equalities
 \[
  h \circ (g \circ f) = (h \circ g) \circ f \, , \quad 1_B \circ f =  f \, , \quad  f \circ 1_A = f \, .
  \] 
  Because of the strict associativity, we omit bracketing of multiple composites and sometimes write simply $gf$ instead of $g \circ f$. 

The presence of identity types in our type theories, however, equips this category with additional structure. In particular,
each  type $A$ has the structure of a weak $\infty$-groupoid having  elements of $A$ as objects, paths
$p \co \Id_A(a,b)$ as 1-morphisms and elements of iterated identity types as $n$-morphisms. 
In light of this fact, we will sometimes write $1_a \co \Id_A(a,a)$ instead of~$\refl(a) \co \Id_A(a,a)$,
$q \circ p \co \Id_A(a,c)$ for the path obtained by composing $p \co \Id_A(a,b)$ and~$q \co \Id_A(a,c)$,
and $p^{-1} \co \Id_A(b,a)$ for the quasi-inverse of $p \co \Id_A(a,b)$. 
When manipulating this structure, we shall simply refer to the  propositional equalities holding between 
various composites as the \emph{groupoid laws}.

The category of types and functions can then be considered as enriched in $\infty$-groupoids,
(and hence as an $(\infty, 1)$-category),  since for each pair of types $A$ and $B$, the type of morphisms $A \to B$ has, like any other type, the structure of an $\infty$-groupoid. Explicitly, this $(\infty, 1)$-category has types as objects,
functions as 1-morphisms, paths $p \co \Id_{A \to B}(f, g)$ as 2-morphisms, and higher paths as $n$-morphisms. We will not need all the structure of this higher-dimensional category, but only some low-dimensional layers of it,
which we assumed defined.  For example, given functions $f \co A \to B$, $g_1, g_2 \co B \to C$ and a path $p \co \Id_{B \to C}(g_1, g_2)$, represented diagrammatically as 
\[
\xymatrix{
A \ar[r]^{f} & B \ar@/^1pc/[r]^{g_1} \ar@/_1pc/[r]_{g_2} \ar@{}[r]|{\Downarrow \, p}  & C \, ,}
\]
it is clear that it is possible to define a path~$p \circ f \co \Id_{A \to C} (g_1 \circ f,  g_2 \circ f)$. Because of the equivalences $\Id_{A \to B}(f,g) \simeq \Hot(f,g)$ recalled above, this $(\infty,1)$-category can be described equivalently
as having  types as objects, functions as 1-morphisms, homotopies $\alpha \co \Hot(f, g)$ as 2-morphisms, and higher homotopies as $n$-morphisms. For example, given functions $f \co A \to B$, $g_1, g_2 \co B \to C$ and a homotopy $\alpha \co \Id(g_1, g_2)$, there is a homotopy $\alpha \circ f \co \Hot(g_1 \circ f, g_2 \circ f)$ which is defined so that, for every $p \co \Id_{B \to C}(g_1, g_2)$, the homotopies~$\ext_{A,C}( p \circ f )$ and  $\ext_{B,C}(p) \circ f$ are propositionally equal. 



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Bipointed types}
\label{sec:bip}

\subsection{Bipointed types and bipointed morphisms} \label{sec:biptm}
In order to motivate our development in this section and the next, 
let us begin by recalling the rules for the type $\Bool$ of Boolean truth values. The introduction rule state that we have two canonical elements in $\Bool$, written $0$ and $1$ here. The elimination rule can be understood as the propositions-as-types translation of an induction principle for $\Bool$. Finally, the computation rules specify what happens if one applies in sequence the introduction and the elimination rule.



\begin{table}[htb]
\fbox{
\begin{minipage}{14cm}
\[
 \Bool \co \type  \qquad \qquad 
0 \co \Bool  \qquad  1 \co \Bool 
\]  
\smallskip
\[
\begin{prooftree}
x\in\Bool \vdash E(x) \co \type \qquad
e_0 \co E(0) \qquad
e_1 \co E(1) 
\justifies
x \co \Bool \vdash \boolind(x, e_0, e_1) \co E(x) 
\end{prooftree}
\] \smallskip

\begin{equation*}
\begin{prooftree}
x\in\Bool \vdash E(x) \co \type \qquad
e_0 \co E(0) \qquad
e_1 \co E(1)
\justifies
  \boolind(0, e_0, e_1)  \deq  e_0 \co E(0) \, , 
\end{prooftree}
 \end{equation*}  
 \bigskip
 \begin{equation*}
\begin{prooftree}
x\in\Bool \vdash E(x) \co \type \qquad
e_0 \co E(0) \qquad
e_1 \co E(1)
\justifies
 \boolind(1,e_0,e_1)  \deq e_1 \co E(1) \, .
\end{prooftree}
 \end{equation*}
 \medskip
 \end{minipage}} \smallskip
 \caption{Rules for the type of Boolean truth values.}
 \end{table}
 
In the presence of the type universe $\U$, as in our underlying type theory $\Hint$, it is natural to have also a rule asserting that $\Bool$ is a small type,  \ie 
$\Bool \co \U$. Let us now suppose to have a small type $A \co \U$ be a small type and suppose that there is an equivalence $f \co \Bool \to A$. Then, the type~$A$ 
has two distinguished elements $a_0 \defeq f(0)$ and $a_1 \defeq f(1)$, and it satisfies
analogues of the elimination and computation rules for $\Bool$, except that the conclusions of the computation 
rules need to be modified  by replacing the judgemental equalities  with propositional ones. Our aim in this section is to provide a characterisation of the small types equivalent to $\Bool$ by means of a type-theoretical universal property. But in our development we shall not assume to have a type $\Bool$, and work in the type theory $\Hint$ specified
in Section~\ref{sec:bac}.  We begin introduce the notion of a bipointed type. 


\begin{definition} \label{thm:bipointedtype}
A \emph{bipointed type} consists of a type $A$ 
and two elements  $a_0 \, , a_1 \co A$. 
\end{definition}



When referring to a bipointed type we sometimes suppress mention of its distinguished elements and write $A = (A, a_0, a_1)$ to recall this abuse of language.  In the following, it will be convenient to represent a bipointed type $A$  
diagrammatically as follows:
\[
\xymatrix{
1 \ar[r]^-{a_0}&  A & 1 \ar[l]_-{a_1} \, .}
 \]
Here, the symbol $1$ does not represent the unit type, which is not assumed as part the type theory $\Hint$.
The type $\Bool$ and its canonical elements $0, 1 \co \Bool$ give us a bipointed type:
\[
\xymatrix{
 1 \ar[r]^-{0}&  \Bool  & 1 \ar[l]_-{1} \, . }
 \]
We say that a bipointed type $A = (A, a_0, a_1)$ is \emph{small} if the type $A$ is a small type, \ie $A \co \U$. 
Accordingly, the type of small bipointed types is then defined by letting 
\[
\Bip \defeq (\Sigma A \co \U)( A \times A ) \, .
\]
Clearly,  this type is not small.  Next, we introduce the notion of a bipointed morphism between bipointed types. 
As one might imagine, a bipointed morphism consists of a function between the underlying types which preserves
the bipointed structure. In our context, we formalize this by requiring the existence of appropriate paths, witnessing the propositional equalities expressing the preservation of structure, as the next definition makes precise. Let us fix two bipointed types $A = (A, a_0, a_1)$ and~$B = (B, b_0, b_1)$. 


\begin{definition} A \emph{bipointed morphism} 
\[
(f, \bar{f}_0, \bar{f}_1)  \co (A, a_0, a_1)  \to (B, b_0, b_1)
\] 
consists of a function $f \co A \to B$ together with paths $\bar{f}_0 \co  \Id(f a_0, b_0)$ 
and~$\bar{f}_1 \co \Id(f a_1, b_1)$.  
\end{definition}

Diagrammatically, we represent a bipointed morphism as follows:
\[
\xymatrix@C=2cm{
1 \ar[r]   \ar[r]^{a_0} \ar@{=}[d]  \ar@{}[dr]|{\Downarrow \, \bar{f}_0} & A  \ar[d]^{f} & 1  \ar[l]_{a_1} \ar@{=}[d] \ar@{}[dl]|{\Downarrow \,  \bar{f}_1} \\
1 \ar[r]_{b_0}  & B   & 1 \ar[l]^{b_1} }
 \]
The type of bipointed morphisms from $A$ to $B$ is then defined by letting
\[
\BipHom(A,B) \defeq (\Sigma f \co A \to B) \big( \Id(  f a_0, b_0 )  \times \Id(  f a_1 , b_1 )  \big) \, .
\]
 Bipointed types and their morphisms behave much like objects and morphisms in a category.
Given two bipointed morphisms  $(f, \bar{f}_0, \bar{f}_1) \co A \to B$ and $(g, \bar{g}_0, \bar{g}_1) \co B \to C$, we can define their composite 
 as the triple consisting of the composite $g \circ f \co A \to C$ and the paths represented
by the following pasting diagram:
\[
\xymatrix@C=2cm@R=1.2cm{
1 \ar[r]   \ar[r]^{a_0} \ar@{=}[d]  \ar@{}[dr]|{\Downarrow \, \bar{f}_0} & A  \ar[d]^{f} & 1  \ar[l]_{a_1} \ar@{=}[d] \ar@{}[dl]|{\Downarrow \,  \bar{f}_1} \\
1 \ar[r]_{b_0}   \ar@{}[dr]|{\Downarrow \, \bar{g}_0}  \ar@{=}[d] & B \ar[d]^f   & 1 \ar[l]^{b_1} \ar@{=}[d] \ar@{}[dl]|{\Downarrow \,  \bar{g}_1} \\
1 \ar[r]_{c_0}  & C   & 1 \ar[l]^{c_1}}
 \]
Explicitly, for $k \in \{ 0, 1 \}$, the path $\overline{g \circ f}_k \co \Id( g f a_0, c_0)$ is obtained as the composite
\[
\xymatrix@C=1.5cm{
g f a_0 \ar[r]^{g(\bar{f}_0)} & g b_0 \ar[r]^{\bar{g}_0} & c_0 \, .}
\]
Also, for any bipointed type $A = (A, a_0, a_1)$, the identity function $1_A \co A \to A$ can be equipped with the structure of a bipointed by taking $\bar{1_A}_0 \co \Id( 1_A(a_0), a_0)$ to be $1_{a_0}$. We represent this as the
diagram
 \begin{equation}
 \label{equ:bipidA}
{\vcenter{\hbox{\xymatrix@C=2cm{
1 \ar[r]^{a_0} \ar@{=}[d] \ar@{}[dr]|{\Downarrow \, 1_{a_0}}& A \ar[d]^{1_A} & 
1 \ar[l]_{a_1} \ar@{=}[d]  \ar@{}[dl]|{\Downarrow \, 1_{a_1}}  \\ 
 1 \ar[r]_{a_0} & A & \; 1 .\ar[l]^{a_1} }}}}
 \end{equation}
The equations for associativity and unit laws in a category do not hold up to judgemental equality, but only 
to a system of higher and higher homotopies, similarly to what happens in a weak $(\infty,1)$-category.  


We have seen in Section~\ref{sec:chait} that for types $A$ and $B$, the identity type of the function type
$A \to B$ can be described equivalently as the type of homotopies between functions from $A$ to $B$. As
we show next, it is possible to extend this equivalence to the identity type of the type of bipointed morphisms
between two bipointed types. In order to do so, we  introduce the notion of a bipointed homotopy between bipointed morphisms in the next definition. 





\begin{definition} \label{thm:biphomotopy} For bipointed morphisms $(f, \bar{f}_0, \bar{f}_1) , (g, \bar{g}_0, \bar{g}_1) \co A \to B$, 
a \emph{bipointed homotopy} 
\[
(\alpha, \bar{\alpha}_0, \bar{\alpha}_1) \co (f, \bar{f}_0, \bar{f}_1) \to  (g, \bar{g}_0, \bar{g}_1)
\] 
consists of a homotopy $\alpha \co  \Hot(f, g)$ and paths
$\bar{\alpha}_0 \co \Id(  \bar{f}_0 ,  \bar{g}_0 \ct \alpha(a_0)  )$ and $\bar{\alpha}_1 \co \Id(
\bar{f}_1 , \bar{g}_1 \ct  \alpha(a_1))$. 
\end{definition}

Diagrammatically, we represent the paths  involved in a bipointed homotopy as follows:
\[
\xymatrix@C=1.5cm{
f(a_k) \ar[r]^{\alpha(a_k)}  \ar@/_1pc/[dr]_{\bar{f}_k}  
\ar@{}[dr]|{\qquad \Rightarrow \; \bar{\alpha}_k}  & g(a_k) \ar[d]^{\bar{g}_k}  \\ 
 & b_k }
  \] 
The type of bipointed homotopies between $f$ and $g$ is then defined by letting
\[
 \BipHot  \big( (f,\bar{f}_0, \bar{f}_1), (g, \bar{g}_0, \bar{g}_1) \big)   \defeq   
 (\Sigma \alpha \co \Hot( f , g)) \big( 
  \Id\big( \bar{f}_0 ,  \alpha(a_0)  \ct \bar{g}_0 \big) \times 
  \Id \big( \bar{f}_1,  \alpha(a_1) \ct  \bar{g}_1 \big) \big) \, ,
\]
where $k \in \{ 0, 1\}$. The next lemma tells us that bipointed homotopies are essentially the
same thing as paths between bipointed morphisms.


\begin{lemma} \label{BoolHomSpace} 
For every  pair of morphisms $(f, \bar{f}_0, \bar{f}_1), (g, \bar{g}_0, \bar{g}_1) \co A \to B$ of bipointed types, the
function 
\[
\ext^{\Bip}_{f,g} \co \Id \big( (f, \bar{f}_0, \bar{f}_1), (g, \bar{g}_0, \bar{g}_1) \big) \to 
\BipHot\big( (f, \bar{f}_0, \bar{f}_1), (g, \bar{g}_0, \bar{g}_1) ) \big) \, .
\]
is an equivalence of types.
\end{lemma}

\begin{proof} Let  $f = (f, \bar{f}_0, \bar{f}_1)$ and $g = (g, \bar{g}_0, \bar{g}_1)$ be bipointed
morphisms from $A$ to $B$. To simplify notation, for a path $p \co \Id( f, g)$, we write $\alpha_p \co \Hot(f, g)$
for the corresponding homotopy. We then have
\begin{align*}
 \Id \big( (f,\bar{f}_0,\bar{f}_1) , (g,\bar{g}_0,\bar{g}_1)  \big)
  &  \simeq (\Sigma p \co \Id( f, g))  \, \Id \big(  (\bar{f}_0,\bar{f}_1),  p^{\ast} (\bar{g}_0,\bar{g}_1) \big) \\
  & \simeq
(\Sigma  p \co \Id(f ,  g)) \, \Id\big( (\bar{f}_0,\bar{f}_1),  \big(\alpha_p(a_0) \ct \bar{g}_0 \, ,  \alpha_p(a_1) \ct \bar{g}_1) \big) \\
& \simeq (\Sigma p  \co \Id(f,g))  \, \Id(\bar{f}_0, \alpha_p(a_0) \ct \bar{g}_0) \times \Id( \bar{f}_1, \alpha_p(a_1) \ct \bar{g}_1) \\
& \simeq (\Sigma \alpha \co \Hot(f, g)) \,  \Id(\bar{f}_0, \alpha(a_0) \ct \bar{g}_0) \times \Id(\bar{f}_1, \alpha(a_1) \ct \bar{g}_1) \\
& = \BipHot \big( (f,\bar{f}_0,\bar{f}_1) \; (g,\bar{g}_0,\bar{g}_1) \big) \, , 
\end{align*} 
as required.
\end{proof}



\subsection{Fibered bipointed types and bipointed sections} Recall that for a dependent type
\[
 x \co A \vdash E(x) \co \type
\]
we referred to an element $f \co (\Pi x \co A) E(x)$ as a \emph{section} of the dependent type,
in analogy with the situation in homotopy-theoretic models, where the dependent type is modelled
as a fibration and the type $(\Pi x \co A)E(x)$ is interpreted as the space of sections (in the usual
category-theoretic sense) of the fibration. It will be convenient to extend these ideas to our 
context by introducing the following definition. 


\begin{definition} \label{def:fibbipointed}
Let $A = (A, a_0, a_1)$ be a bipointed type. A \emph{fibered bipointed type over $A$}
\[
(E, e_0, e_1)
\]  
is a dependent type $x \co A \vdash E(x) \co \type$ together with elements $e_0 \co E(a_0)$ and $e_1 \co E(a_1)$.
We say that  such a fibered bipointed type  is \emph{small} if, for
$x \co A$, we have $E(x) \co \U$.  
\end{definition}

The type of  small fibered bipointed types over a bipointed type $A$ is then defined by letting
\[
\FibBip(A) \defeq (\Sigma E \co A \to \U) \big( E(a_0) \times E(a_1) \big) \, .
 \]
 Note that this type is not small. Given a fibered bipointed type $E =(E, e_0, e_1)$ over $A = (A, a_0, a_1)$, its total type is defined by letting
\[
E'  \defeq (\Sigma x \co A) E(x) \, .
\] 
Observe that $E'$ is a bipointed type by considering $e'_k \defeq \pair(a_k, e_k)$, 
for $k \in \{ 0, 1 \}$. In this way, the first projection $\pi_1 \co E' \to A$ becomes a bipointed morphism:
\[
\xymatrix@C=2cm{
1  \ar[r]^-{e'_0} \ar@{=}[d] \ar@{}[dr]|{\overline{(\pi_1)}_0} & E' \ar[d]^{\pi_1} & 1 \ar[l]_-{e'_1} \ar@{=}[d]
\ar@{}[dl]|{\overline{(\pi_1)}_1}   \\ 
 1 \ar[r]_{a_0} & A  &  \ar[l]^{a_1} }
 \]




\begin{definition} \label{def:fibsection} Let $E = (E, e_0, e_1)$ be a fibered bipointed type over
$A = (A, a_0, a_1)$.  A \emph{bipointed section} of $E$, 
\[
(f, \bar{f}_0, \bar{f}_1) \co A \to E \, ,
\]
is a function $f \co (\Pi x \co A) E(x)$ together with paths~$\bar{f}_0 \co \Id_{E(a_0)}(f a_0, e_0)$ 
and $\bar{f}_1 \co  \Id_{E(a_1)}( f a_1 , e_1)$. 
\end{definition} 


The type of bipointed sections of $E = (E, e_0, e_1)$ is then defined to be
\[
\BipSec(A,E) \defeq (\Sigma f \co (\Pi x \co A)E(x) ) \; \big(
  \Id_{E(a_0)}(f a_0,  e_0)  \times \Id_{E(a_1)}( fa_1, e_1)  \big) \, .
\]
Given a bipointed section $f \co A \to E$, we can define a bipointed morphism~$f'  \co A \to E'$, where $E'$ is the
total bipointed type associated to $E$. Its underlying function is given by 
letting,  for~$x \co A$, 
\[
f'(x) \defeq \pair(x, s(x)) \, .
\] 
With this definition, it is 
immediate to get the path~$\bar{f'}_k \co \Id( f' a_k ,  e'_k)$, for $k \in \{ 0, 1\}$.
The morphism $f' \co A \to E'$ provides a pointwise right inverse for~$\pi_1 \co E' \to A$,
 since, for~$x \co A$, we have judgemental equalities
\[
 (\pi_1 \circ f')(x) \deq \pi_1 (f' x) \deq \pi_1\, \pair(x, f x) \deq x \, .
\]
 We represent this situation with the diagram
\[
\xymatrix{
E' \ar[d]_{\pi_1} \\
A . \ar@/_1.2pc/[u]_{f'} }
\]
We characterize the identity type between two bipointed sections, using
the notion of a bipointed homotopy. This is in complete analogy with the situation for bipointed
morphisms discussed in Lemma~\ref{BoolHomSpace}. 


\begin{definition} \label{def:2cellsection} Let $E$ be a fibered bipointed type over $A$. If $f = (f, \bar{f}_0,\bar{f}_1)$ and $g = (g, \bar{g}_0, \bar{g}_1)$ are bipointed sections of $E$, a \emph{bipointed homotopy} 
\[
(\alpha, \bar{\alpha}_0, \bar{\alpha}_1) \co (f, \bar{f}_0, \bar{f}_1)  \rightarrow (g, \bar{g}_0, \bar{g}_1)
\]
is a homotopy~$\alpha \co \Hot(f, g)$ together with paths $\bar{\alpha}_0 \co \Id(  \bar{f}_0 ,  \bar{g}_0 \ct \alpha(a_0)  )$ and $\bar{\alpha}_1 \co \Id(
\bar{f}_1 , \bar{g}_1 \ct  \alpha(a_1))$.
\end{definition} 



The type of bipointed homotopies between bipointed sections $f$ and $g$ as above is then defined by letting:
\[
\BipHot \big( (f, \bar{f}_0, \bar{f}_1), (g, \bar{g}_0, \bar{g}_1) \big) \defeq
(\Sigma \alpha \co \Hot( f, g)) 
\Id\big( \bar{f}_0 ,  \alpha(a_0)  \ct \bar{g}_0 \big) \times 
  \Id \big( \bar{f}_1,  \alpha(a_1) \ct  \bar{g}_1 \big) 
 \, .
\]


\begin{lemma} \label{thm:biphot}
Let $E = (E, e_0, e_1)$ be a fibered bipointed type over a bipointed type $A = (A, a_0, a_1)$. 
For every pair of bipointed sections $f = (f, \bar{f}_0, \bar{f}_1)$ and $g = (g, \bar{g}_0, \bar{g}_1)$, 
the canonical function
\[
\ext^{\BipHot}_{f,g} \co \Id\big( (f, \bar{f}_0, \bar{f}_1), (g, \bar{g}_0, \bar{g}_1) \big) \rightarrow
\BipHot \big( (f, \bar{f}_0, \bar{f}_1), (g, \bar{g}_0, \bar{g}_1) \big) \, .
\]
is an equivalence of types. 
\end{lemma}


\begin{proof} The claim follows by an argument analogous to that of Lemma~\ref{BoolHomSpace}.
\end{proof}




\subsection{Bipointed equivalences} We introduce the notion of equivalence between bipointed types and show
in Proposition~\ref{thm:usemere}  that a bipointed morphism is an equivalence of bipointed types if and only its underlying function is an equivalence of types. This fact will be used in Section~\ref{sec:unibip} where we consider the counterpart of the Univalence Axiom for bipointed types. 



\begin{definition} We say that a bipointed morphism $f \co A \to B$ is a \myemph{bipointed equivalence}
if there exist bipointed morphisms $g \co B \to A$ and $h \co B \to A$ which provide a left and a right bipointed inverse for $f$, \ie such that there exist paths $p \co \Id_{\Bip(A,A)}(g  f, 1_A)$ 
and $q \co \Id_{\Bip(B,B)} ( f  h, 1_B)$.
\end{definition}

For a bipointed morphism $f \co A \to B$, the type of proofs that $f$ is a bipointed equivalence is
then defined by letting
\[
\isbipequiv(f) \defeq   (\Sigma g \co \BipHom(B,A)) \,  \Id_{\Bip(A,A)}( g  f, 1_A ) \times 
    (\Sigma h \co \BipHom(A, B)) \, \Id_{\Bip(B,B)} (f  h , 1_B ) \, ,
\]
and type of bipointed equivalences between $A$ and $B$ is defined by letting
\[
\BipEquiv(A, B)
\defeq    
(\Sigma f \co \BipHom(A,B)) \, \isbipequiv(f)  \, . 
\] 


\begin{lemma} The underlying function of a bipointed equivalence is an equivalence. In particular,
for every bipointed morphism $(f, \bar{f}_0, \bar{f}_1) \co A \to B$  there is a  function 
\[
\pi_f \co \isbipequiv(f) \to \isequiv(f) \, .
\]
\end{lemma} 

\begin{proof} Let $(f, \bar{f}_0, \bar{f}_1) \co A \to B$ be a bipointed morphism. Unfolding  the definition
of  $\isbipequiv(f)$ yields the type
\begin{multline}
\label{equ:unfoldisbipequiv} 
(\Sigma g \co B \to  A)
(\Sigma \bar{g}_0 \co \Id( g b_0, a_0)) 
(\Sigma  \bar{g}_1 \co \Id( g b_1, a_1)) \, 
 G(g,\bar{g}_0,\bar{g}_1) \, \times \\
 (\Sigma h \co B \to A)
 (\Sigma \bar{h}_0 \co \Id ( h b_0,  a_0))
 (\Sigma \bar{h}_1 \co  \Id ( h b_1,  a_1)) \, 
 H(h,\bar{h}_0,\bar{h}_1)   \, ,
\end{multline}
where $G(g, \bar{g}_0, \bar{g}_1)$ is the type of proofs that the
bipointed morphism  $g  f \co A \to A$ is propositionally equal to the identity bipointed morphism
$1_A \co A \to A$ and and  $H(h, \bar{h}_0, \bar{h}_1)$ is the type of proofs that the
bipointed morphism  $f  h \co B \to B$ is propositionally equal to the identity bipointed morphism
$1_B \co A \to B$. For example, the elements of $G(g, \bar{g}_0, \bar{g}_1)$ can be thought of as
proofs that the pasting diagram 
\[
\xymatrix@C=2cm@R=1.2cm{
1    \ar[r]^{a_0} \ar@{=}[d]  \ar@{}[dr]|{\Downarrow \, \bar{f}_0} & A  \ar[d]^{f} & 1  \ar[l]_{a_1} \ar@{=}[d] \ar@{}[dl]|{\Downarrow \,  \bar{f}_1} \\
1 \ar[r]_{b_0}   \ar@{}[dr]|{\Downarrow \, \bar{g}_0}  \ar@{=}[d] & B \ar[d]^g   & 1 \ar[l]^{b_1} \ar@{=}[d] \ar@{}[dl]|{\Downarrow \,  \bar{g}_1} \\
1 \ar[r]_{a_0}  & A   & 1 \ar[l]^{a_1}}
\]
is propositionally equal to the diagram representing the identity bipointed morphism in~\eqref{equ:bipidA}. 
Explicily, we have
\begin{align*}
G(g,\bar{g}_0,\bar{g}_1) & \defeq 
\Id 
\big( \, 
\langle 
g f \, ,  \overline{gf}_0  \, ,    \overline{gf}_1 
\rangle \, , \;
\langle 
1_A \, ,  1_{a_0} \, , 1_{a_1} 
\rangle \, 
\big)  \, , \\
H(h,\bar{h}_0,\bar{h}_1) & \defeq 
\Id 
\big( 
\langle
 f  h \, ,   \overline{fh}_0 \, , \overline{fh}_1   
 \rangle \, , \; 
 \langle 
 1_B \, ,  1_{b_0} \, , 1_{b_1} 
 \rangle 
 \big) \, .
\end{align*}
Using the characterization of identity types of $\Sigma$-types in Section~\ref{sec:chait}, the type $G(g,\bar{g}_0,\bar{g}_1)$ can be  expressed equivalently as
\[
(\Sigma p \co  \Id( g f, 1_A)) \, 
\Id 
\big(  
\langle 
\overline{gf}_0  \, ,    \overline{gf}_1 
\rangle \, ,  \; 
 p^*
 \langle 
 1_{a_0} \, , 1_{a_1}  
 \rangle  
 \big) \, ,
\]
where, for $p \co \Id(gf, 1_A)$, 
\[
p^* \co \Id( 1_A(a_0), a_0) \times \Id(1_A(a_1), a_1) \to \Id( gf(a_0), a_0) \times \Id( gf(a_1), a_1) 
\]
is the controvariant version of the transport function associated to $p$. Similarly, the type~$H(h, \bar{h}_0, \bar{h}_1)$ is equivalent to 
\[
(\Sigma q \co  \Id( f h, 1_B)) \, 
\Id 
\big(  
\langle 
\overline{fh}_0  \, ,    \overline{fh}_1 
\rangle \, ,  \; 
 q^*
 \langle 
 1_{b_0} \, , 1_{b_1}  
 \rangle  
 \big) \, ,
\]
Thus, rearranging the order of the $\Sigma$-types in~\eqref{equ:unfoldisbipequiv} and using the
characterization of identity types in product types, we get that 
\begin{multline}
\label{equ:equivdescisbipequiv}
\isbipequiv(f) \simeq  \\ (\Sigma g \co B \to A)(\Sigma p \co \Id(gf, 1_A))\,  G'(g,p) \times
(\Sigma h \co B \to A)(\Sigma q \co \Id(fh, 1_B))\, H'(h,q) \, , 
\end{multline}
where 
\begin{align} 
G'(g,p) & \defeq 
(\Sigma \bar{g}_0 \co \Id( g b_0, a_0)) \, \Id( \overline{gf}_0, p^*(1_{a_0}) ) \times 
(\Sigma  \bar{g}_1 \co \Id( g b_1, a_1)) \, \Id( \overline{gf}_1, p^*(1_{a_1}) ) \, ,
 \label{equ:bipgp} \\
 H'(h,q) & \defeq 
 (\Sigma \bar{h}_0 \co \Id ( h b_0,  a_0)) \, \Id ( \overline{fh}_0 , q^*(1_{b_0})) \times 
 (\Sigma \bar{h}_1 \co  \Id ( h b_1,  a_1)) \, \Id (   \overline{fh}_1 \, ,  q^*(1_{b_1})) \, .  \label{equ:biphq}
 \end{align} 
 Note that the elements of~$G'(g,p)$ are tuples consisting of paths $\bar{g}_0$, $\bar{g_1}$ making the function~$g$ into a bipointed morphism and of paths $\bar{p}_0$, $\bar{p}_1$ making the path $p$ into a path between
bipointed morphisms. Of course, the elements $H'(h,q)$ admits a similar description. 
The required  function  is then obtained 
by composing the equivalence in~\eqref{equ:equivdescisbipequiv} with the projection 
forgetting the components from $G'(g,p)$ and $H'(h,q)$. 
\end{proof} 


In Proposition~\ref{thm:usemere} we will give an alternative characterisation of bipointed 
equivalences, which will be used in the proof of Theorem~\ref{thm:bipunivalence} and Corollary~\ref{BoolHInitIso}.
Intuitively, it asserts that if the underlying function of a bipointed morphism is an equivalence, there is an 
essentially unique way of making $f$ into a bipointed equivalence, \ie of equipping its left and right inverses
with the structure of bipointed morphisms so as to obtain bipointed inverses. In order to prove this result,
we need the following straightforward lemma.



\begin{lemma} \hfill \label{thm:useful}
\begin{enumerate}[(i)]
\item Let $A$ be a type and $a, a_1, a_2 \co A$. For paths $p_1 \co \Id(a,a_1)$, $p_2 \co \Id(a,a_2)$, the type 
\[
(\Sigma q \co \Id_A(a_1,a_2)) \, \Id( q \ct p_1 \, , p_2)
\] 
is contractible. 
\item Let $f \co A \to B$ be an equivalence, $a_1, a_2 \co A$ and $b \co B$. For paths $p_1 \co \Id(b, f a_1)$, 
$p_2 \co \Id(b, fa_2)$, the type 
\[
(\Sigma q \co \Id_A(a_1,a_2)) \, \Id(f(q) \ct p_1 , p_2)
\] 
is contractible.
\end{enumerate}
\end{lemma}




\begin{proposition}  \label{thm:usemere}  A bipointed morphism $(f, \bar{f}_0, \bar{f}_1) \co A \to B$ is a bipointed equivalence if and only
if its underlying function $f \co A \to B$ is an equivalence. In fact,  the  function
\[
\pi_f \co \isbipequiv(f, \bar{f}_0, \bar{f}_1)  \to \isequiv(f) \, .
\]
is an equivalence of types. 
\end{proposition}  

\begin{proof}
Let  $(f, \bar{f}_0, \bar{f}_1) \co A \to B$ be a bipointed morphism. We wish to show that the homotopy fibers
of the function $\pi_f$ are contractible. So, let us fix an element of $\isequiv(f)$, given by a functions $g \co B
\to A$, $h \co B \to A$ and paths $p \co \Id(gf, 1_A)$ and $q \co \Id(fh, 1_B)$. By the definition of~$\pi_f$ we have
an equivalence 
\[
\hfiber(\pi_f, (g,h, p, q)) \simeq G'(g,p) \times H'(h,q) \, ,
\]
 where $G'(g,p)$ and $H'(h,q)$ are defined
in~\eqref{equ:bipgp} and~\eqref{equ:biphq}, respectively. 
We claim that $G'(g,p)$ and $H'(h,q)$ are contractible. Since
the proofs are essentially the same, we consider only $G'(g,p)$.  

Let $k \in \{0, 1 \}$. For a path $p \co \Id(gf, 1_A)$, the path $p^*(1_{a_k}) \co \Id( gf a_k, b_k)$ can be proved by $\Id$-elimination to be propositionally equal to $\ext(p)(a_k) \co \Id(gfa_k, b_k)$, where $\ext(p) \co \Hot(gf, 1_A)$. Combining this fact with the definition of composition of bipointed morphisms, we obtain that
$G'(g,p)$ is equivalent to the product of the types
\[
(\Sigma \bar{g}_k \co \Id( gb_k, a_k)) \, \Id ( \bar{g}_k \ct (g \circ \bar{f}_k), \ext(p)(a_k))
\]
for $k \in \{0, 1 \}$. But, for $k \in \{ 0, 1 \}$, the type above is equivalent to 
\[
(\Sigma \bar{g}_k \co \Id( gb_k, a_k)) \, \Id ( \bar{g}_k \, , \ext(p)(a_k) \ct  (g \circ \bar{f}_k)^{-1} )
\]
which is contractible by Lemma~\ref{thm:useful}. Hence $G'(h,p)$ is contractible, as required.
\end{proof}


\begin{corollary} For any bipointed morphism $(f, \bar{f}_0, \bar{f}_1)$, the type $\isbipequiv(f, \bar{f}_0, \bar{f}_1)$ is a mere proposition.
\end{corollary} 





\section{Homotopy-initial bipointed types} 
\label{sec:homibt}


\subsection{Inductive bipointed types} 
As we mentioned  in Section~\ref{sec:biptm}, if a type $A$ is equivalent to $\Bool$, then 
it satisfies the counterparts of the elimination and computation rules for $\Bool$ in which the computation rule is 
weakened by replacing the judgmental equality in its conclusion with a propositional equality. Using the notions of a small fibered bipointed type and of a bipointed section introduced in Section~\ref{sec:bip}, it is immediate to see that the these rules rules imply that every fibered bipointed type over~$A$, and in particular every fibered small bipointed type, has a bipointed section. 
Since bipointed types $A$ of this kind  play an important role in the following, we introduce some terminology to refer to them.


 



\begin{definition} A bipointed type $A$ is said to be \emph{inductive} if every fibered small bipointed type over it has a bipointed section, \ie the type
\[ 
\isbipind(A) \defeq (\Pi E \co \FibBip(A))  \BipSec(E)
\]  
is inhabited. \end{definition} 



\begin{remark} For every bipointed type $A = (A, a_0, a_1)$, the type $\isbipind(A)$ is a mere proposition. Indeed, recall that to prove that a type  is a mere proposition, it suffices to do so under the assumption that it is inhabited. Assume therefore that~$\isbipind(A)$ is inhabited. Since the dependent product of a family of mere propositions is again a mere proposition, it suffices to show that~$\BipSec(A,E)$ is a mere proposition for any $E$. But for any two bipointed sections~$f, g \co \BipSec(A,E)$, we know that there is a 
bipointed homotopy $\alpha \co \BipHot(f,g)$ by Lemma~\ref{thm:inductiveuniquesec} and hence, by 
Lemma~\ref{thm:biphot}, there is a path $p \co \Id(f,g)$, as required. 
\end{remark}

We define the type of small inductive bipointed types by letting
\[
\mathsf{BipInd} \defeq (\Sigma A \co \Bip) \isbipind(A) \, .
\]
Thus, a canonical inductive bipointed type is given by a bipointed type $A = (A, a_0, a_1)$ together with a function 
which, given a fibered bipointed type $E = (E, e_0, e_1)$ over $A$, returns a bipointed section of $E$.
Clearly, the type $\Bool$ is an inductive bipointed type. Furthermore, the property of being inductive can be transported along equivalences, in the sense that if $A$ and $B$ are equivalent bipointed types and $A$ is inductive, then so is $B$. Thus, a
type is equivalent to $\Bool$ if and only if it is inductive. Below,
we begin to explore some consequences of the assumption that a bipointed type is inductive, with the goal
of arriving at a 
characterisation of inductive bipointed types.



\begin{proposition} \label{thm:inductiverules}
Let $A = (A, a_0, a_1)$ be a bipointed type. Then $A$ is inductive if only if it satisfies the following rules:
\begin{enumerate}[(i)]
\item the elimination rule
\[
\begin{prooftree}
x \co A \vdash E(x) \co \U \qquad
e_0 \co E(a_0) \qquad
e_1 \co E(a_1) 
\justifies
x \co A \vdash \elim(x, e_0, e_1) \co E(x) \, , 
\end{prooftree} 
\]
\item the computation rules 
\[
\begin{prooftree}
x\co A \vdash E(x) \co \U \qquad
e_0 \co E(a_0) \qquad
e_1 \co E(a_1)
\justifies
\comp_k(e_0, e_1) \co \Id \big(    \elim(a_k, e_0, e_1), e_k \big) \, ,
\end{prooftree}  
\]
where $k \in \{ 0, 1\}$.
\end{enumerate}
\end{proposition}

\begin{proof} Immediate.
\end{proof}

Note that the rules in Proposition~\ref{thm:inductiverules} are exactly the elimination rule
and the weakening computation rules for $\Bool$ obtained by restricting the eliminating
type to families of small dependent types and, most importantly,  replacing the judgemental
equality in the conclusion with a propositional one, as mentioned above. The next lemma
shows that, for an inductive bipointed type~$A$, then not only every fibered bipointed type over it
has a section, but that such a section is unique up to a bipointed homotopy.

\begin{proposition} \label{thm:inductiveuniquesec} Let $A = (A, a_0, a_1)$ be a bipointed type. If $A$ is inductive, 
then the following rules are derivable:

\begin{enumerate}[(i)]
\item the $\eta$-rule
\[
\begin{prooftree}
\begin{array}{c} 
x \co A \vdash E(x) \co \U \quad
e_0 \co E(a_0) \quad
e_1 \co E(a_1) \quad
x \co A \vdash f x \co E(x) \quad
\bar{f}_0 \co \Id(fa_0, e_0) \quad
\bar{f}_1 \co \Id(fa_1, e_1)
\end{array}
\justifies
x \co A \vdash \eta_x \co \Id(f x,  \elim(x, e_0, e_1))
\end{prooftree} \bigskip
\]
\item the coherence rule
\[
\begin{prooftree}
\begin{array}{c} 
x \co A \vdash E(x) \co \U \quad
e_0 \co E(a_0) \quad
e_1 \co E(a_1) \quad
x \co A \vdash f(x) \co E(x) \quad
\bar{f}_0 \co \Id(f a_0, e_0) \quad
\bar{f}_1 \co \Id(f a_1, e_1)
\end{array}
\justifies
\bar{\eta}_k \co \Id \big( \comp_k(e_0, e_1)  \ct \eta_{a_k} \, , \;  \bar{f}_k \big)
\end{prooftree}
\]
\noindent
where $k \in \{ 0, 1 \}$.
\end{enumerate}
\end{proposition}

Before proving Proposition~\ref{thm:inductiveuniquesec}, observe that the paths in the conclusion of 
the coherence rule can be represented diagrammatically as follows:
\[
\xymatrix@C1.5cm{
fa_k \ar[r]^-{\eta_{a_k}} \ar@{=}[d]   \ar@{}[dr]|{\Downarrow \, \bar{\eta}_k}& \elim(a_k, e_0, e_k) \ar[d]^{\comp_k(e_0, e_1)} \\
fa_k \ar[r]_{\bar{f}_k} & e_k}
 \]


\begin{proof}[Proof of Proposition~\ref{thm:inductiveuniquesec}] Let us assume the premisses of the $\eta$-rule. For $x \co A$, define $F(x) \co \U$  by letting~
\[
F(x) \defeq 
\Id(fx, \elim(x, e_0, e_1)) \, .
\] 
With this notation, proving the conclusion of the $\eta$-rule amounts to defining
$\eta_x \co F(x)$, for $x \co A$. We do so using the elimination rule for $A$, as stated in Propositon~\ref{thm:inductiverules}.
Thus, we need to find elements $p_k \in F(a_k)$ for $k \in \{0, 1\}$. Since
\[
F(a_k) = \Id(fa_k, \elim(a_k, e_0, e_1)) \, ,
\]
such paths can be constructed as the composite
\[
\xymatrix@C=2.2cm{
 fa_k \ar[r]^{\bar{f}_k} &
 e_k \ar[r]^-{ \comp_k(e_0, e_1)^{-1}}& 
  \elim(a_k, e_0, e_1)  \, .}
\]
For $x \co A$, we can then defined the required element $\eta_x \co F(x)$ by letting 
\[
\eta_x \defeq \elim(x, p_0, p_1) \, . 
\]
In order to prove the coherence rule, note that the computation rule of Propositon~\ref{thm:inductiverules} then gives us a path in $\Id(\eta_{a_k},  p_k)$, \ie  $\Id( \eta_{a_k},  \comp_k(e_0, e_1)^{-1} \ct \bar{f}_k ) $. 
The required paths can then be obtained using the groupoid laws.
 \end{proof} 
 

\subsection{Homotopy-initial bipointed types} 
 Let $A$ be a small bipointed type and assume that it is inductive. 
  If we focus on the special case of fibered small bipointed types that 
are constant, \ie we have simply a small bipointed type $B$, then 
 Proposition~\ref{thm:inductiverules} and Lemma~\ref{thm:inductiveuniquesec}
imply that there exists a bipointed morphism~$f \co A \to B$, which is unique in the sense that  for any two bipointed morphisms $(f, \bar{f}_0, \bar{f}_1), (g, \bar{g}_0, \bar{g}_1) \co A \to B$  there is a bipointed homotopy~$\alpha \co f \sim g$. Thus, by Lemma~\ref{BoolHomSpace}, there is a path 
\[
p \co \Id((f, \bar{f}_0, \bar{f}_1), (g, \bar{g}_0, \bar{g}_1)) \, .
\] 
Furthermore, it can be shown that such a path is itself is unique up to a higher path, which in turn is unique up to a yet higher path, etc... As we will show in the reminder of this section, this sort of weak $\infty$-universality, which apparently involves infinitely much data, can nonetheless be fully captured within the system of type theory (without resorting to coinduction) using ideas inspired by homotopy theory and higher-dimensional category theory. Indeed, in spite of the fact that bipointed types and morphisms do not form a category in a strict sense, it is possible to introduce the  notion of a homotopy-initial bipointed type in completely elementary and explicit terms, as we do in the next definition.


\begin{definition}\label{def:BoolInit}
A small bipointed type $A$ is said to be \emph{homotopy-initial}  if for any small bipointed type $B$, the type $\BipHom(A,B)$ of bipointed morphisms from $A$ to $B$
is contractible, \ie the type
\[
\ishinit(A) \defeq (\Pi B \co \Bip) \, \iscontr(\BipHom(A, B) )
\] 
is inhabited.
\end{definition}

Let us remark that the uniqueness implicit in Definition~\ref{def:BoolInit} requires that any two bipointed homomorphisms are propositionally equal as tuples. It should also be noted that the property of being  homotopy-initial  can be transported along equivalences, in the sense that if two bipointed types are equivalent, then one is homotopy-initial if and only if the other one is. It is worth emphasizing also that homotopy-initiality is a purely type-theoretic notion: despite having an intuitive homotopy-theoretic interpretation, it is formulated in terms of inhabitation of specific, definable types. Note that, for a bipointed type $A$, being homotopy-initial is a property of the type, in the
sense that $\ishinit(A)$ is a mere proposition. Indeed, the type $\iscontr(B)$ is a mere proposition for any type $B$ and the dependent product of family of mere propositions is again a mere proposition.  The next proposition spells out spells out a  characterization of homotopy-initial bipointed types in terms of type-theoretic rules.


\begin{proposition} \label{thm:hinitrules}
A small bipointed type $A = (A, a_0, a_1)$ is homotopy-initial if and only if it satisfies
 the following rules:
 
 \begin{enumerate}[(i)]
 \item the recursion rule
 \[
\begin{prooftree}
B \co \U \qquad
b_0 \co B \qquad
b_1 \co B 
\justifies
x \co A \vdash \rec(x, b_0, b_1) \co B 
\end{prooftree} 
\]
\item the $\beta$-rules
\[
\begin{prooftree}
B \co \U \qquad
b_0 \co B  \qquad
b_1 \co B
\justifies
\beta_k \co \Id(  \rec(a_k, b_0, b_1), b_k ) 
\end{prooftree}  
\]
where $k \in \{0, 1\}$, 
\item the $\eta$-rule
\[
\begin{prooftree}
(B, b_0, b_1) \co \Bip \quad
(f, \bar{f}_0, \bar{f}_1) \co \Bip(A,B)
\justifies
x \co A \vdash \eta_x \co \Id(fx, \rec(x, b_0, b_1) )
\end{prooftree}  
\]
\item the $(\beta, \eta)$-coherence rule
\[
\begin{prooftree}
(B, b_0, b_1) \co \Bip \quad
(f, \bar{f}_0, \bar{f}_1) \co \Bip(A,B) 
\justifies
\bar{\eta}_k \co \Id( \beta_k \ct \eta_{a_k} \, , \; \bar{f}_k) 
\end{prooftree}
\]
 where $k \in \{ 0, 1 \}$.
 \end{enumerate}
\end{proposition}



\begin{proof} The claim follows by unfolding the definition of homotopy-initiality.
\end{proof} 

\medskip


The next theorem provides the characterisation of inductive bipointed types.






\begin{theorem}\label{thm:bipointedmain} A small bipointed type 
is  $A$ is inductive if and only if it is homotopy-initial, \ie  the type
\[
(\Pi A \co \Bip) \big(  \isbiphinit(A) \leftrightarrow \isbipind(A) \big)
\] 
is inhabited
\end{theorem}

\begin{proof} Let $A = (A, a_0, a_1)$ be a small bipointed type. 

First, we show that if $A$ is inductive then
it is homotopy-initial. But this follows immediately observing that the rules characterising homotopy-initial bipointed types in Proposition~\ref{thm:hinitrules}
are special cases of the rules in Proposition~\ref{thm:inductiverules} and Lemma~\ref{thm:inductiveuniquesec},
which are provable for inductive bipointed types. 

For the other implication, 
let us assume that $A = (A, a_0, a_1)$ is homotopy-initial and prove that it is inductive. 
For this, let~$E = (E, e_0, e_1)$ be a fibered small bipointed type over $A$. We need to show that there
exists a bipointed section
\begin{equation}
\label{equ:reqsec}
(s, \bar{s}_0, \bar{s}_1) \co A \to E
\end{equation}
Let us begin by considering the total bipointed type associated to $E$, with carrier 
\[
E' \defeq (\Sigma x \co A) E(x) 
\]
and distinguished elements 
\[
e'_k \defeq \pair(a_k, e_k) \, , 
\]
for $k \in \{ 0, 1 \}$. In this way,  the first projection $\pi_1 \co 
E' \to A$ is a bipointed morphism. By the homotopy-initiality of $A$, we have a bipointed morphism 
\[
(f, \bar{f}_0, \bar{f}_1) \co (A, a_0, a_1)  \to (E', e'_0, e'_1) 
\]
which we represent with the diagram
\[
\xymatrix@C=2cm{
1 \ar[r]^{a_0} \ar@{=}[d] \ar@{}[dr]|{\Downarrow \, \bar{f}_0} & A  \ar[d]^f & 1 \ar[l]_{a_1} \ar@{=}[d]
 \ar@{}[dl]|{\Downarrow \, \bar{f}_1}   \\
1 \ar[r]_{e'_0}  & E' & 1 \ar[l]^{e'_1} }
 \]
 We can compose $f \co A \to E'$ with $\pi_1 \co E' \to A$ and obtain a bipointed morphism $\pi_1 \circ f \co A \to A$, which is represented by the diagram
  \[
\xymatrix@C=2cm@R=1.2cm{
1  \ar[r]^{a_0} \ar@{=}[d]  \ar@{}[dr]|{\Downarrow \, \bar{f}_0}  & A  \ar[d]^f & 1 \ar[l]_{a_1}  \ar@{=}[d]  
 \ar@{}[dl]|{\Downarrow \, \bar{f}_1} \\
\ar[r]^{e'_0} \ar@{=}[d]   \ar@{}[dr]|{\Downarrow \, \bar{\pi}_0}  & E' \ar[d]^{\pi_1}  & 1 \ar[l]_{e'_1} \ar@{=}[d] 
 \ar@{}[dl]|{\Downarrow \, \bar{\pi}_1}  \\
1 \ar[r]_{a_0} & A &  1 \ar[l]^{a_1}}
 \]
But the identity $1_A \co A \to A$ is also a bipointed morphism and therefore, by the homotopy-initiality of $A$, there is an element of $\Id_{\Bip(A,A)}(\pi_1  f, 1_A)$. 
 By Lemma~\ref{BoolHomSpace}, this gives us a bipointed homotopy $(\alpha,
\bar{\alpha}_0,\bar{\alpha}_1) \co \BipHot( \pi_1 \circ f , 1_A)$. This amounts to a homotopy $\alpha \co \Hot(\pi_1 
\circ f, 1_A)$ and paths
\begin{equation*}
\bar{\alpha}_k \co  \Id( \overline{(\pi_1 \circ f)}_k \, , \;  \alpha_{a_k} \cdot 1_{a_k} ) \, . 
\end{equation*}
for $k \in \{ 0, 1 \}$. We begin to define the required bipointed section as in~\eqref{equ:reqsec}, by defining, for~$x \co A$, 
\begin{equation*}
% \label{equ:defreqsection}
s(x) \defeq (\alpha_x)_{!} \big( \pi_2 f  x \big) \, .
\end{equation*}
We now construct  paths~$\bar{s}_k \co \Id(s a_k, e_k)$, for $k \in \{ 0, 1 \}$. First of all, recall that 
$\bar{f}_k \co \Id( f a_k, e'_k)$, where $e'_k = \pair(a_k, e_k) \co (\Sigma x \co A) E(x)$. Using the 
characterization of identity types of $\Sigma$-types, we define
\[
p \defeq \pi_1 \, \ext^\Sigma(\bar{f}_k)  \co  \Id( \pi_1 f  a_k \, ,\;   \pi_1 e'_k )  
\]
and
\[
q \defeq  \pi_2 \, \ext^\Sigma(\bar{f}_k) \co   \Id( p_{!}( \pi_2 f  a_k), \pi_2 e'_k)   \, .
\]
Furthermore, we have 
\begin{alignat*}{4}  
\overline{(\pi_1 \circ f)}_k  & \iso  (\overline{\pi_1})_k \ct (\pi_1 \circ \bar{f}_k)  & & \qquad (\text{by definition of } \pi_1 f)   \\
& \iso  1_{a_k}  \ct (\pi_1 \circ \bar{f}_k)  & & \qquad (\text{by definition of } \pi_1)  \\
 & \iso (\pi_1 \circ \bar{f}_k) & & \qquad (\text{by the groupoid laws}) \\
 & \iso p  & & \qquad (\text{by definition of } \ext^\Sigma) \,  . \\
 \intertext{Therefore, we can construct the following chain of paths:}
p & \iso  \overline{(\pi_1 f)}_k & &  \qquad (\text{by what we just proved})  \\
  & \iso 1_{a_k} \ct  \alpha(a_k)  & &  \qquad (\text{by the path } \bar{\alpha}_k ) \\ 
  & \iso  \alpha(a_k)  & & \qquad (\text{by the groupoid laws}) \\
\intertext{Hence,  the required path $\bar{s}_k \co  \Id(s a_k,  e_k)$ can be defined as the following composite:}
s(a_k) & \deq \alpha(a_k)_{!} \big( \pi_2 f a_k   \big) & & \qquad (\text{by the definition of } s) \\
 &              \Rightarrow   p_{!} \big( \pi_2 f a_k   \big) & & \qquad (\text{since there is a path } p \Rightarrow \alpha(a_k)) \\
   &            \Rightarrow  e_k  & &  \qquad (\text{by the path } q)  \, .
   \end{alignat*} 
   This concludes the proof.
\end{proof}


The proof of Theorem~\ref{thm:bipointedmain} simplifies considerably within the extensional
type theory~$\Hext$ obtained by adding to $\Hint$ the identity reflection rule in~\eqref{equ:collapse}. In that type theory, 
there is a judgemental equality 
between the composite $\pi_1 f \co A \to A$ and the identity $1_A \co A \to A$, with which the
rest of the argument can be shortened considerably. In that setting, one obtains the familiar characterisation 
of an inductive type by means of a standard universal property.

\begin{remark} 
Let us remark that, for a bipointed type $A$, there is actually an equivalence  
\[
\isbiphinit(A) \simeq \isbipind(A) \, ,
\]
since $\isbiphinit(A)$ and $\isbipind(A)$ are a mere propositions. 
\end{remark} 

The next proposition characterises the
type $\Bool$ up to equivalence.



\begin{corollary}[$\Hint + \Bool$]  For a bipointed type $A = (A, a_0, a_1)$, the following 
conditions are equivalent:
\begin{enumerate}[(i)]
\item $A$ is inductive,
\item $A$ is homotopy-initial,
\item $A$ and $\Bool$ are equivalent as bipointed types.
\end{enumerate}
In particular, $\Bool$ is a homotopy-initial bipointed type.
\end{corollary}





\subsection{Univalence for bipointed types} \label{sec:unibip}
We conclude this section by showing that if the universe~$\U$ is assumed to be univalent, then a form of the Univalence Axiom holds also for bipointed types, in the sense made precise by the next theorem, where we
use notation analogous to the one introduced in Section~\ref{sec:bac}. 


\begin{theorem}[$\Hint + \mathrm{UA}$] \label{thm:bipunivalence}
For small bipointed types $A, B \co \Bip$, the  canonical function
\[ 
\ext^{\Bip}_{A,B} \co \Id_{\Bip} \big(A,B\big) \to  \BipEquiv(A,B) \, .
\] 
is an equivalence.
\end{theorem} 

\begin{proof} 
Let $ (A,a_0,a_1), (B,b_0,b_1)$ be small bipointed types. By the characterization of the identity types
of  elements of a $\Sigma$-type, the 
identity type $\Id\big( (A,a_0,a_1),  (B,b_0,b_1)\big)$ is equivalent to  the type
\[
(\Sigma p \co \Id_\U(A,B))  \, \Id(\langle a_0,a_1 \rangle,  p_{!} \langle b_0,b_1\rangle)  \, .
\]
By $\Id$-elimination and the characterization of paths in product types, this type is equivalent to
\[ 
(\Sigma p \co \Id_\U(A,B)) \, \Id \big( f_p(a_0),  b_0\big) \times \Id \big( f_p(a_1) , b_1) \, ,
 \]
where we write $f_p \co A \to B$ for the equivalence associated to a path $p \co \Id_\U(A,B)$.  By the Univalence Axiom,
the above type is equivalent to
\[ 
(\Sigma f \co \Eq(A,B)) \, \Id \big( f a_0 ,  b_0\big) \times \Id \big( f a_1 , b_1\big)  \, .
\]
After rearranging, we get
\[
(\Sigma f  \co A \to B)(\Sigma \bar{f}_0 \co \Id( fa_0, b_0)) (\Sigma \bar{f}_1 \co \Id( fa_1, b_1))  \, \isequiv(f) \, ,
\]
which is equivalent to $\BipEquiv(A,B)$ by Proposition~\ref{thm:usemere}. Finally, it is not hard to see that the composition of the above equivalences yields the  function $\ext^{\Bip}_{A,B}$ up to a homotopy, thus showing that it is an equivalence, as required.
\end{proof} 

\begin{corollary}[$\Hint + \mathrm{UA}$] \label{BoolHInitIso} 
Homotopy-initial small bipointed types are unique up to a contractible type of paths, i.e. the type
\[ 
(\Pi A \co \Bip) (\Pi B \co \Bip)
\big( \isbiphinit(A) \times \isbiphinit(B) \to \iscontr(\Id_\Bip(A,B)) \big) \, .
\] 
is inhabited.
\end{corollary}

\begin{proof} Let $A$ and $B$ be homotopy-initial bipointed types. 
By Theorem~\ref{thm:bipunivalence} it suffices to prove that the type $\BipEquiv(A,B)$ is contractible. The type 
$\BipHom( A, B)$ is contractible by homotopy-initiality of $A$. Since the dependent sum of a family of mere propositions over a mere proposition is again a mere proposition, it suffices to prove that the type $\isbipequiv(f)$ is contractible for any bipointed morphism $f \co A \to B$. This type is a mere proposition by 
Proposition~\ref{thm:usemere}, and thus it suffices to show it is inhabited. But the existence of a right and a left bipointed inverse for $f$ follows immediately
by the assumption that $A$ and $B$ are homotopy-initial.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Polynomial functors and their algebras}
\label{section:wfiles}

\subsection{Algebras and algebra morphisms}
The aim of the rest of the paper is to carry out a similar analysis for well-ordering types, or W-types. We recall
the rules for W-types in Table~\ref{tab:wrules}. There, we sometimes write $W$ for~$(\W x \co A) B(x)$ for
brevity.  Informally, 
a W-type can be seen as the free algebra for a signature
with arbitrarily many operations of possibly infinite arity, but no equations. Indeed, the premises of the formation rule above can be thought of as specifying a signature that has the elements of the type $A$ as~(names of) operations and in which the arity of $a \co A$ is (the cardinality of) the type $B(a)$. Then the introduction rule specifies the canonical way of forming an element of the free algebra, and the elimination rule can be seen as the propositions-as-types translation of the appropriate induction principle. As usual, the computation rule states what happens if we apply the
the elimination rule to a canonical element of the inductive type.

\begin{table}[htb]
\fbox{\begin{minipage}{14.5cm}
\[
\begin{prooftree}
 A \co \type \qquad
 x \co A \vdash B(x) \co \type
 \justifies
 \textstyle
 (\W x \co A) B(x) \co \type
\end{prooftree} \qquad 
\begin{prooftree}
a \co A \qquad
t \co B(a) \to W
\justifies
\wsup(a,t)\co W
\end{prooftree}
\]
\bigskip
\[
\begin{prooftree}
w \co W \vdash E(w) \co \type  \quad
x \co A,\, u \co B(x) \to W,\, v \co (\Pi y \co B(x)) E(uy) \vdash e(x,u,v) \co E(\wsup(x,u))
\justifies
 w \co W \vdash \wind(w,e) \co E(w)
 \end{prooftree} \]
 \bigskip
 \[
\begin{prooftree}
w \co W \vdash E(w) \co \type  \quad
x\co A,\, u \co B(x) \to W,\, v \co (\Pi y \co B(x)) E(u y)  \vdash e(x,u,v) \co E(\wsup(x,u))
\justifies
x\co A,\, u \co B(x) \to W \vdash  \wind(\wsup(x,u),e) = e(x,u, ( \lambda y \co B(x)) \,\wind(u y,s_E)) \co E(\wsup(x,u))
\end{prooftree} \medskip
\]
\end{minipage}} \smallskip
\caption{Rules for $W$-types.} 
\label{tab:wrules}
\end{table}


We now consider a small type $A \co \U$ and a small dependent type $B \co A \to \U$, which we consider
fixed for this section and the next. For $C \co \U$,
we define
\[
PC \defeq (\Sigma x \co A) (B(x) \to C) \, .
\]
In this way, we obtain a function $P \co \U \to \U$. This operation on types extends to an operation on functions between 
 types, as follows. For $f \co C \to D$, we define $P f  \co PC \to PD$ by $\Sigma$-elimination
so that, for $\pair(x, u) \co PC$, we have 
\[
(Pf )( \pair(x, u)) = (x,f\circ u) \, .
\] 
Although this assignment is not strictly functorial, we still refer to  as the \emph{polynomial functor} associated to $A$ and $B$, so as to highlight the analogy with the theory of polynomial functors on locally cartesian closed categories.

\begin{definition} A \emph{$P$-algebra} consists of a small type $C \co \U$ and a function $\sup_C \co PC \to C$. 
\end{definition}

\smallskip

 The type of $P$-algebras is then defined as 
 \[
 \Palg  \defeq (\Sigma C \co \U) (PC \to C) \, .
 \]
 Given a $P$-algebra $C = (C, \sup_C)$,
 we refer to the type $C$ as the \emph{carrier} or \emph{underlying type} of the algebra and to the function $\sup_C \co PC\to C$ as the \emph{structure map} of the $P$-algebra. 
 As usual,  we will often refer to a 
 $P$-algebra by mentioning only its carrier. We adopt similar conventions for other kinds of structures that we consider
 in the following.  In the
 presence of W-types, an example of $P$-algebra is given by the type $W \defeq (\W x\co A)B(x)$, with structure map given by the introduction rule for W-types. 
Let us now fix $P$-algebras $C = (C, \sup_C)$ and $D = (D, \sup_D)$. 

\begin{definition} A \emph{$P$-algebra morphism}
\[
(f, \bar{f}) \co (C, \sup_C) \rightarrow (D, \sup_D)
\]
consists of a function $f \co C \rightarrow D$ and a path $\bar{f} \co \Id(\sup_{D} \circ P f \, ,  f \circ \sup_C)$.
\end{definition}

A $P$-algebra morphism as above can be represented with a diagram of the form
\[
\xymatrix{
 PC \ar[d]_{\sup_C} \ar[r]^{Pf}  \ar@{}[dr]|{\Downarrow \, \bar{f}} &  PD \ar[d]^{\sup_D}\\
C \ar[r]_{f}   & D}
\] 
Informally, one can think of the path $\bar{f}$ as a proof that the square diagram commutes, which is the 
requirement defining the notion of morphism of endofunctor algebras in category theory, or as invertible
2-cell, as in the notion of a pseudo-morphism between algebras in 2-dimensional category theory.  
Accordingly, the type of $P$-algebra 
morphisms between $C$ and $D$ is defined by
\[
\Palg(C,D)
 \defeq  
(\Sigma f:  C \rightarrow D) \, \Id(\sup_D \circ P f  \, , f\circ \sup_C  )  \, .
\]
We now define the composition operation for $P$-algebra morphisms. Given $(f, \bar{f}) \co C \to D$ and~$(g, \bar{g}) \co D \to E$,
their composite 
\[
(g, \bar{g}) \circ (f, \bar{f}) \co (C, \sup_C) \to (E, \sup_E)
\] 
is obtained as follows. Its underlying function is given by $gf\co C \to E$, and so the 
the required path must be of the form
\[
 \overline{(g \circ f)} \co \Id\big(  \sup_E \circ P(g \circ f) \, ,  (g \circ f) \circ \sup_C \big)\, .
\]
Such a path is obtained by pasting the diagrams 
\[
\xymatrix@C=2cm{
 PC \ar[d]_{\sup_C} \ar[r]^{Pf}  \ar@{}[dr]|{\Downarrow \, \bar{f}} &  
 PD \ar[d]^{\sup_D}  \ar[r]^{Pg}  \ar@{}[dr]|{\Downarrow \, \bar{g}} &  PE \ar[d]^{\sup_E} \\
C \ar[r]_{f}   & D \ar[r]_{g}   & E \,  }
\]
More precisely, it is given by the following composition of paths:
\[
\xymatrix@C=1.3cm{
\sup_E \circ P (g \circ f) \ar[r]^-{\sup_E \circ \psi_{f,g}} &
 \sup_E \circ P(g) \circ P(f) \ar[r]^-{\bar{g} \circ P(f)} & 
 g \circ \sup_D \circ P(f) \ar[r]^{g \circ \bar{f}} & 
g \circ f \circ \sup_C\, .}
\]
Note that we used the pre-composition and post-compositions of functions with paths. 
For a $P$-algebra $C$,  the identity function $1_C \co C \to C$ has an evident structure of $P$-algebra morphism:
\begin{equation}
\label{equ:palgid}
\xymatrix@C=1.5cm{
PC \ar[r]^{P(1_C)}  \ar[d]_{\sup_C} \ar@{}[dr]|{\Downarrow \, \overline{1}_C} & PC \ar[d]^{\sup_C} \\
C \ar[r]_{1_C} & \; C \, .}
\end{equation}
As in the case of bipointed types, the equations for a category do not hold up to judgemental equality, but only so up to a system of higher and higher identities. 

\medskip

We will require an alternative description of the identity type between two $P$-algebra morphisms. For this, we introduce 
the notion of a $P$-algebra homotopy in the next definition.


\begin{definition}
For $P$-algebra morphisms $(f, \bar{f}) \, , (g, \bar{g}) \co C \to D$, a \emph{$P$-algebra homotopy}  
\[
(\alpha, \bar{\alpha}) \co (f, \bar{f}) \sim (g, \bar{g})
\] 
consists of a homotopy $\alpha \co\Hot( f , g)$ and a path
$\bar{\alpha} \co \Id( \bar{g} \cdot \sup_D (P \alpha) ,  \alpha(\sup_C)\cdot \bar{f})$. 
\end{definition}

Such a $P$-algebra homotopy can be thought of as a proof that the two paths produced by the pasting diagrams
\[
\xymatrix@C=1.5cm@R=1.2cm{
PC \ar@/^1pc/[r]^{Pf}   \ar[d]_{\sup_C}   \ar@/_1pc/[r]_{Pg} \ar@{}[r]|{\Downarrow \, P\alpha}
& PD \ar[d]^{\sup_D}  \\
C  \ar@/_1pc/[r]_g  \ar@{}[r]^{\Downarrow \, \bar{g}} & D }
\qquad
\xymatrix@C=1.5cm@R=1.2cm{
PC \ar@/^1pc/[r]^{Pf}   \ar[d]_{\sup_C} \ar@{}[r]_(.52){\Downarrow \, \bar{f}}  & PD \ar[d]^{\sup_D}  \\
C \ar@/^1pc/[r]^f  \ar@/_1pc/[r]_g  \ar@{}[r]|{\Downarrow \, \alpha} & D }
\]
are equal, which is the condition defining an algebra 2-cell in 2-dimensional category theory.  Also observe that~$\alpha(\sup_C)$ and $\sup_D(P \alpha)$ are obtained by pre-composition and post-compositions, respectively, of maps with homotopies.  The type of $P$-algebra homotopies is then defined by
\[
\AlgHot \big( (f,\bar{f}), (g, \bar{g})  \big)
 \defeq  
(\Sigma \alpha \co \Hot(  f , g)) \, \Id\big( \bar{g} \cdot \sup_D(P \alpha),\, (\alpha(\sup_C))\cdot \bar{f} \big) \, .
\]


\newcommand{\HotAlg}{\mathsf{HotAlg}}


\begin{lemma}\label{IdEqHo}
For every pair of $P$-algebra morphisms $(f, \bar{f}) \, , (g, \bar{g}) \co C \to D$,  
the canonical function
\[
\ext^{\Palg}_{f,g}  \co 
\Id\big((f, \bar{f}), (g, \bar{g})\big) \to \HotAlg \big((f, \bar{f}), (g, \bar{g})\big).
\]
 is an equivalence of types. 
\end{lemma}

\begin{proof}
This follows from a more general statement to be proved in Proposition~\ref{lem:fibhomeqid} below.
\end{proof}

\subsection{Fibered algebras and algebra sections} We now introduce the fibered versions of the notions of a $P$-algebra, $P$-algebra morphism, and $P$-algebra homotopy. Let us make some
preliminary remarks in order to motivate our definitions. 
Suppose $C = (C, \sup_C)$ is a $P$-algebra and let $E \co C \to \U$ be a small fibered type.
We wish to describe what data determines a $P$-algebra structure on the type $E' \defeq (\Sigma z \co C) E(z)$. First of all, observe that we have 
\begin{align*}
PE' & = (\Sigma x \co A)  (B(x) \to (\Sigma z \co C)E(z)) \\
 & \simeq (\Sigma x \co A) (\Sigma u \co B(x) \to C) (\Pi y \co B(x)) E (uy) 
\end{align*}
using a special case of the $\Pi\Sigma$-distributivity recalled in~\eqref{equ:ac}. 
Therefore, we have
\begin{align*} 
PE' \to E' \ & \simeq 
 (\Sigma x \co A) (\Sigma u \co B(x) \to C) (\Pi y \co B(x)) E (uy)  \to (\Sigma z \co C) E(z) \\ 
 & \simeq (\Pi x \co A)(\Pi u \co B(x) \to C) (\Pi v \co (\Pi y \co B(x)) E(uy)) (\Sigma z \co C) E(z) 
\end{align*}
and so a structure map $\sup_{E'} \co PE' \to E'$ can be viewed equivalently as a function $s$ which 
takes arguments $x \co A$, $u \co B(x) \to C$, $v \co (\Pi y \co B(x))E(uy)$ and returns $s(x,u,v) \co (\Sigma z \co C) E(z)$.
Thus, if we wish to ensure that the structure map $\sup_{E'} \co PE' \to E'$ is such that the projection function
 $\pi_1 \co E' \to C$ is a $P$-algebra morphism,  \ie that we can find a path fitting in the diagram
 \[
 \xymatrix@C=1.2cm{
 PE' \ar[r]^-{P \pi_1} \ar[d]_{\sup_{E'}} \ar@{}[dr]|{\Downarrow \,  \overline{\pi}_1} & PC \ar[d]^{\sup_C} \\
 E' \ar[r]_{\pi_1} & \; C \, ,}
 \]
it is sufficient to have a function
\[
e \co (\Pi x \co A)(\Pi u \co B(x) \to C) (\Pi v \co (\Pi y \co B(x)) E(uy))  E(\sup_C(x,u)) \, . 
 \]  
 We are therefore led to make the following definition. 

\begin{definition} \label{def:fibalg}
Let $C$ be a $P$-algebra. A \emph{fibered $P$-algebra} over $C$ consists of a dependent type $E \co C \to \U$
and a function 
\[
e \co  (\Pi x \co A) (\Pi u \co B(x) \to C)   ((\Pi y \co B(x))   E(u y))  \,  E(\sup_C(x,u))
 \] 
\end{definition}

Let us also remark that a function $e$ as above appears also in one of the premisses of the
elimination rule for $W$-types. For a $P$-algebra $C$, we then define the type of fibered $P$-algebras 
over $C$ as follows:
\[
\Palg(C) \defeq (\Sigma E \co C \to \U) (\Pi x \co A) (\Pi u \co B(x) \to C) 
 ((\Pi y \co B(x)) E(u y))\,  E(\sup_C(x,u))
 \]
 
 \begin{remark} 
Given a fibered $P$-algebra $E = (E, e)$, we will refer to the $P$-algebra structure
on $E' = (\Sigma z \co C) E(z)$ given by the function $\sup_{E'} \co PE' \to E'$ associated to 
the function $e$ as the canonical $P$-algebra structure on $E'$. Explicitly, the structure
map can be defined by $\Sigma$-elimination so that, for $x \co A$, $u \co B(x) \to E'$, we have
\[
\sup_{E'}(x,u) = 
\pair \big( 
\sup_C(x, \pi_1 u ) \, , 
e( x, \pi_1 u, \pi_2 u) \big) \co E' \, .
\]
Here, note that $\pi_1 u \co B(x) \to C$ and $\pi_2 u \co (\Pi y \co B(x)) E(\pi_1 u y)$ and so,
by the type of $e$, we have that~$e(x, \pi_1 u, \pi_2 u) \co E( \sup_C(x, \pi_1 u))$, as required.
\end{remark} 

Analogously to the way we defined fibered $P$-algebras, it is possible to define 
$P$-algebra sections. To state this definition, we need some preliminary notation.
Given a fibered $P$-algebra $E = (E, e)$ and  $f \co (\Pi z \co C) E(z)$,
we define $e_f \co (\Pi x \co A)(\Pi u \co B(x) \to C) E(\sup_C(x,u))$ by 
mapping~$x \co A$ and $y \co B(x)$ to 
\begin{equation}
\label{equ:ef}
 e_f(x,u) \defeq e(x, u, f u) \, .
\end{equation}
Here, note that for $y \co B(x)$, we have $u y \co C$ and hence $f u y \co E(uy)$,
as required.


\begin{definition} \label{def:fibalgsection} Let $E = (E, e)$ be a fibered $P$-algebra over a $P$-algebra $C$.  
A \emph{$P$-algebra section} of $E$ consists of a function $f \co (\Pi z \co C) E(z)$ and a path 
$\bar{f} \co  \Id \big( e_f \, , f \circ \sup_C \big)$.
\end{definition} 

\medskip

We then define the type of $P$-algebra sections of $C$ by letting
\[ 
\PalgSec(C,E)  \defeq (\Sigma f  \co (\Pi x \co C) E(x)) \; \Id \big( e_f \, , f \circ \sup_C \big) \, .
\]



\begin{remark*}
Given a $P$-algebra section $(f, \bar{f})$ of a fibered $P$-algebra $E = (E, e)$, there is a $P$-algebra 
morphism $f' \co C \to E'$, where $E' = (\Sigma x \co C) E(x)$ is considered as equipped with its canonical 
$P$-algebra structure: 
\[
\xymatrix{
PC \ar[r]^{Pf'} \ar[d]_{\sup_C} \ar@{}[dr]|{\Downarrow \, \overline{f'}} & PE' \ar[d]^{\sup_{E'}} \\
C \ar[r]_{f'} & E'}
\]
Here, $f' \defeq (\lambda z \co C) \, \pair(z, fz)$. This $P$-algebra morphism provides
a section of the $P$-algebra morphism~$\pi_1 \co E' \to C$ in the sense that the composite $P$-algebra
morphism~$\pi_1 \circ f' \co C \to C$ can be shown to be propositionally equal to the identity $P$-algebra
morphism~$1_C \co C \to C$. 
\end{remark*}

\medskip


We will require an analysis of paths between of $P$-algebra sections and thus we introduce, in Definition~\ref{def:W2cellsection} below, the
notion of a $P$-algebra section homotopy. In order to state the definition more briefly, let us introduce some
notation. For a fibered $P$-algebra $E = (E,e)$, functions $f, g \co (\Pi z \co C) E(z)$ and a path $p \co
\Id(f,g)$, we write $e_p \co \Id(e_f, e_g)$ for the evident path defined by $\Id$-elimination, 
where~$e_f$ and~$e_g$ are defined as in~\eqref{equ:ef}. By the equivalence between homotopies
and paths discussed in Section~\ref{sec:chait}, for a homotopy $\alpha \co \Hot(f,g)$ we also have
a homotopy~$e_\alpha \co \Hot(e_f, e_g)$. 

\begin{definition} \label{def:W2cellsection} Let $E = (E, e)$ be a fibered $P$algebra over $C$, and let $f = (f, \bar{f})$ and $g = (g, \bar{g})$ be two $P$-algebra sections of $E$.  A \emph{$P$-algebra section homotopy} 
\[
(\alpha , \bar{\alpha}) \co (f, \bar{f})  \rightarrow (g, \bar{g})
\] 
is a homotopy~$\alpha \co \Hot(f, g)$ and a homotopy
\[
\bar{\alpha} \co 
(\Pi x \co A) (\Pi u \co B(x) \to C) \;
\Hot\big( \ext( \bar{g})  \ct e_\alpha \, , 
(\alpha \circ \sup_C) \ct \ext( \bar{f}) \big) \, .
\]
\end{definition} 

For $P$-algebra section homotopy $(\alpha, \bar{\alpha})$ as above, the path $\bar{\alpha}$ can be
represented diagrammatically as fitting in the following diagram
\[
\xymatrix@C=2cm{
e_f(x,u) \ar[r]^{e_\alpha(x,u)} \ar[d]_{\ext(\bar{f})(x,u)} 
\ar@{}[dr]|{\Downarrow \, \bar{\alpha}(x,u)}  
& e_g(x,u) \ar[d]^{\ext(\bar{g})(x,u)}  \\
f ( \sup_C(x,u)) \ar[r]_{\alpha( \sup_C(x,u))}  & g(\sup_C(x,u))}
\]
Accordingly, we define the type of $P$-algebra homotopies of sections as follows:
\[
\AlgSecHot( (f, \bar{f}) ,\, (g, \bar{g}) )  \defeq 
(\Sigma \alpha \co \Hot( f , g)) 
(\Pi x \co A) 
(\Pi u \co B(x) \to C) \, 
\Id\big(  \bar{g}  \ct e_\alpha \, , 
(\alpha \circ \sup_C) \ct \bar{f} \big) \, .
\]
The choice of terminology is justified by the fact that  a 
$P$-algebra section homotopy $(\alpha, \bar{\alpha}) \co (f, \bar{f}) \sim (g, \bar{g})$, 
determines a $P$-algebra homotopy 
$(\alpha', \overline{\alpha}')$ between the corresponding $P$-algebra morphisms $f', g' \co C \to E'$.
In spite of the complexity of its definition, the notion of a $P$-algebra homotopy is essentially equivalent to
that of an identity proof between $P$-algebra sections, as the next lemma makes precise. 

\begin{lemma}\label{lem:fibhomeqid} Let $E = (E, e)$ be a fibered algebra over a $P$-algebra $C$.
For every pair of $P$-algebra sections $(f, \bar{f})$ and $(g, \bar{g})$,  the function
\[
\ext_{(f, \bar{f}), (g, \bar{g})} \co \Id \big( (f, \bar{f}) ,\, (g, \bar{g}) \big) \, \to
\AlgSecHot\big( (f, \bar{f}) ,\, (g, \bar{g}) \big) 
\]
is an equivalence of types.
\end{lemma}

\begin{proof} Let us recall that $f, g \co (\Pi z \co C) E(z)$ and, for $x \co A$, $u \co B(x) \to C$, 
we have
\[
\bar{f} \co  \Id(e_f, f \circ \sup_C ) \, , \quad
\bar{g}\co  \Id( e_g, g \circ \sup_C)  \, .
\]
Now, for $p \co \Id(f, g)$ we have $p_{!}(\bar{f}) \co  \Id( e_g ,  g \circ \sup_C)$ 
and it can be shown by $\Id$-elimination that there exists a path 
$q  \co \Id\big( p_{!}(\bar{f})  \ct e_p  \, , (p \circ \sup_C) \ct \bar{f}  \big)$, 
which can be represented with the diagram
\[
\xymatrix@C=2cm{
e_f  \ar[r]^-{e_p}  \ar[d]_{\bar{f}}  \ar@{}[dr]|{\Downarrow \, q } & e_g  
\ar[d]^{ p_{!}(\bar{f})  }  \\
f \circ \sup_C \ar[r]_-{p \circ \sup_C}  & g \circ \sup_C }
\]
We then have
\begin{align*}
  \Id\big( (f,\bar{f}),  (g,\bar{g}) \big) 
& \simeq (\Sigma p \co \Id( f , g)) \; \Id ( p_{!} ( \bar{f} ) \, , \bar{g}  )  \\
&  \simeq (\Sigma p \co \Id( f , g)) \; \Id (  \bar{g} \, , p_{!} ( \bar{f} )  )  \\
& \simeq (\Sigma p \co \Id( f, g)) 
\; \Id\big(  \bar{g}   \, , 
(p \circ \sup_C) \ct \bar{f} \ct e_p^{-1}  \big)   \\ 
& \simeq (\Sigma p \co \Id( f, g)) 
\; \Id\big(  \bar{g}  \ct e_p  \, ,   (p \circ \sup_C) \ct \bar{f}  \big)   \\ 
& \simeq (\Sigma p \co \Id( f, g)) 
\; \Hot \big(  \ext(\bar{g}) \ct e_{\ext(p)}    \, , 
(\ext(p) \circ \sup_C) \ct \ext(\bar{f})   \big)   \\ 
&  \simeq (\Sigma \alpha \co \Hot( f, g)) \; \Id\big(  \ext(\bar{g})  \ct e_\alpha \, , 
(\alpha \circ \sup_C) \ct \ext(\bar{f}) \big) \\
&  =   \AlgSecHot \big( (f,\bar{f}) \; (g,\bar{g}) \big) \, . \qedhere
\end{align*}  
\end{proof}




\subsection{Algebra equivalences}  We introduce the notion of equivalence between $P$-algebras, which
will useful in Section~\ref{sec:univalencealgebras}, where will prove that assuming the Univalence Axiom, a form of univalence holds also for $P$-algebras. 



\begin{definition}  
We say that a $P$-algebra morphism $f \co C \to D$ is 
 a~\emph{$P$-algebra equivalence}
if there exist $P$-algebra morphisms $g, h \co D \to C$  which provide a left and a right $P$-inverse for $f$ as a
$P$-algebra morphism, \ie for
which there are paths of $P$-algebra morphisms
\[ 
p \co \Id_{\Palg(C,C)}( g  f,  1_C) \, , \quad q \co \Id_{\Palg(D,D)}( f h , 1_D) \, .
\]
\end{definition}
 
Given a $P$-algebra morphism $f \co C \to D$, we define the type of proofs that $f$ is an equivalence of $P$-algebras as follows:
\[
\isalgequiv(f) \defeq  (\Sigma g \co  \Palg(C,D)) \Id( g f, 1_C )  \times 
    (\Sigma h  \co \Palg(D, C)) \Id( f h , 1_D ) \, .
\]
We then define the type of $P$-algebra equivalences between $C$ and $D$ as
\[
\AlgEquiv(C, D)
\defeq   (\Sigma f \co \Palg(C,D)) \, \isalgequiv(f)  \, . 
\] 


\begin{lemma} The underlying function of a $P$-algebra equivalence is an equivalence. In particular, 
for every $P$-algebra morphism $(f, \bar{f}) \co C \to D$ there is a function 
\[
\pi_f \co \isalgequiv(f, \bar{f})  \to \mathsf{isequiv}(f)  
\]
\end{lemma}

\begin{proof} Let $(f, \bar{f}) \co C \to D$ be a $P$-algebra morphism. 
Unfolding the definition, we have
\begin{multline*}
\isalgequiv(f, \bar{f}) \defeq \\	 (\Sigma g \co D \to C) 
	 \big( \Sigma \bar{g} \co \mathsf{isalghom}(g) \, 
 		G(g, \bar{g})  \times
	 (\Sigma h \co D \to C) 
	 \big(\Sigma \bar{h} \co   \mathsf{isalghom}(h) )
	 \,  H(h, \bar{h}) \, , 
\end{multline*}
where 
$G(g, \bar{g})$ and $H(h, \bar{h})$ are the types of proofs that $(g, \bar{g})$ and $(h, \bar{h})$ are a left and right inverse for $(f, \bar{f})$ as 
$P$-algebra morphisms, respectively. For the right inverse, this amounts to requiring that the pasting diagram
\[
\xymatrix@C=1.5cm{
PC \ar[r]^{Pf} \ar[d]_{\sup_C} \ar@{}[dr]|{\Downarrow \, \bar{f}}  & PD \ar[r]^{Pg} \ar[d]^{\sup_D} 
\ar@{}[dr]|{\Downarrow \, \bar{g}}  & PC \ar[d]^{\sup_C}  \\
C \ar[r]_{f}   & D  \ar[r]_g & C \, .}
\]
is propositionally equal to the diagram for the identity $P$-algebra morphism on $C$ in~\eqref{equ:palgid}. 
Explicitly, we have
\begin{align*}
G(g,\bar{g}) & 
\defeq 
\Id \big( ( g  f,  \overline{gf}), (1_C, \overline{1}_C) \big)  \\
H(h,\bar{h})    & \defeq \Id \big( (   f h,  \overline{ f h}), (1_D, \overline{1}_D) \big)  \, .
\end{align*}
Using the characterization of paths in $\Sigma$-types, we have
\begin{align*}
G(g, \bar{g}) & \simeq (\Sigma p \co \Id(g f ,  1_C) ) \, 
	\Id\big( \overline{gf}   ,\, p^*( \overline{1}_C)  \big) \, , \\
H(h, \bar{h}) & \simeq (\Sigma q \co \Id( f h ,  1_C) ) \, 
	\Id\big( \overline{fh}   ,\, q^*( \overline{1}_C)  \big) \,. \
\end{align*}
Thus, rearranging the $\Sigma$-types in the definition, we have
\begin{multline}
\label{equ:isalgequivequiv}
\isalgequiv(f, \bar{f}) \simeq \\ 
 (\Sigma g \co D \to C)  (\Sigma p \co \Id(g f ,  1_C) ) \, G'(g,p) \times
   (\Sigma h \co D \to C)   (\Sigma q \co \Id( f h ,  1_C) )\,  H'(h,q) \, ,
\end{multline}
where 
\begin{align} 
G(g,p) & \defeq (\Sigma \bar{g} \co \mathsf{isalghom}(g)) \; \Id( \overline{gf}, p^*(\bar{1}_C)) \, , 
\label{equ:alggp} \\
H(h,q) & \defeq (\Sigma \bar{h} \co \mathsf{isalghom}(h)) \; \Id( \overline{fh}, q^*(\bar{1}_D)) ) \, .
\label{equ:alghq}
\end{align}
The  canonical elements of~$G(g,p)$ are pairs $(\bar{g}, \bar{p})$ consisting of  a path~$\bar{g}$ making
$g$ into a $P$-algebra morphism and a path~$\bar{p}$ making $p \co \Id(gf, 1_C)$ into a propositional
equality between the~$P$-algebra morphisms~$(gf, \overline{gf})$ and~$(1_C, \bar{1}_C)$. It is now
clear that we can obtain the required function $\pi_f$ by composing the equivalence in~\eqref{equ:isalgequivequiv}
with the evident projection to $\isequiv(f)$. 
\end{proof} 

This amounts to saying that there is an essentially unique way of turning a left
(respectively, right) inverse of $f$ as a function into a left (respectively, right) inverse of $f$
as a $P$-algebra morphism.

\begin{proposition}\label{WAlgSpace} A $P$-algebra morphism $(f, \bar{f}) \co C \to D$ is an equivalence of
$P$-algebras if and only
if its underlying function $f \co C \to D$ is an equivalence of types. In particular, the function 
\[
\pi_f \co \isalgequiv(f, \bar{f})  \to \mathsf{isequiv}(f)  
\]
is an equivalence. 
\end{proposition}  




\begin{proof} Let $(f, \bar{f}) \co (C, \sup_C) \to (D, \sup_D)$ be a  $P$-algebra morphism. We will to
show that all the homotopy fibers of the function $\pi_f$ are contractible.
So, let us consider a canonical element of the codomain of $\pi_f$,  given by a 4-tuple $( g, h, p, q) \co \mathsf{isequiv}(f)$ consisting of functions $g \co D \to C$ and $h \co D \to C$ and paths $p \co \Id(gf, 1_C)$, $q \co \Id(fh, 1_D)$,
exhibiting~$g$ and~$h$ as a right and a left inverse of $f$ (as a function, not as a $P$-algebra morphism), respectively. 

The homotopy fiber of $\pi_f$ over this element can be thought of as the type consisting of all
the data that is missing from having a left and a right inverse of $f$ as a $P$-algebra morphism. 
In particular, we have
\begin{equation*}
\hfiber(\pi_f, (g, h, p, q ) ) \simeq G'(g,p) \times H'(h,q) \, ,
\end{equation*}
where $G'(g,p)$ and $H'(h,q)$ are defined as in~\eqref{equ:alggp} and~\eqref{equ:alghq}, respectively.
Therefore, it suffices to prove that $G'(g,p)$ and $H'(h,q)$ are  contractible.  The proof that $G'(g,p)$ and $H'(h,q)$ are 
contractible is essentially the same, so we consider only $G'(h,p)$.


First of all,  recall that the path $\overline{gf} \co  \mathsf{isalghom}(gf) $ is given by 
\[
\overline{gf} \defeq (g \circ \bar{f}) \ct (\bar{g} \circ Pf ) \, ,
\]
where we suppressed the path relative to the pseudo-functoriality of $P$ for convenience. 
By $\Id$-elimination on $p$, the path $p^*(\overline{1}_C) \co \mathsf{isalghom}(gf)$ is propositionally equal to the composite path
\[
\xymatrix@C=1.7cm{
\sup_C \circ P(gf) \ar[r]^{\sup_C \circ P(p)} & \sup_C \circ P(1_C) \ar[r]^{\bar{1}_C} & 1_C \circ \sup_C \ar[r]^{p^{-1} \circ \sup_C} & 
(g f) \circ 1_C }
\]
Hence, we have 
\begin{align*} 
G(g,p)  & \simeq  (\Sigma \bar{g} \co  \mathsf{AlgHom}(g))  \; 
\Id \big( (g \circ \bar{f}) \ct (\bar{g} \circ Pf ) \, , 
  (p^{-1} \circ \sup_C) \ct \bar{1}_C \ct (\sup_C \circ P(p)) \big) \\
& \simeq 
(\Sigma \bar{g} \co  \mathsf{AlgHom}(g))  \; 
\Id \big( \bar{g} \circ Pf  \, , (g \circ \bar{f})^{-1} \ct 
  (p^{-1} \circ \sup_C) \ct \bar{1}_C \ct (\sup_C \circ P(p)) \big)
\end{align*} 
Now, since $f \co C \to D$ is an equivalence, $Pf \co PC \to PD$ is also an equivalence and hence so
is the function mapping a path $r \co \Id_{PD \to C}(s,t)$ to the composite $r \circ Pf \co \Id_{PC \to C}( s \circ Pf, t \circ Pf)$. Thus, by  Lemma~\ref{thm:useful}, $G'(g,p)$ is contractible, as required.
\end{proof} 




\begin{corollary} For every $P$-algebra morphism $(f, \bar{f})$, the type $\isalgequiv(f, \bar{f})$ is
a mere proposition. 
\end{corollary} 

 

\section{Homotopy-initial $P$-algebras}

\subsection{Inductive algebras}
Given a $P$-algebra $C = (C, \sup_C)$ and a type $D$, an equivalence of types $f \co C \to D$ makes $D$ into a $P$-algebra with structure map $s_D \co PD \to D$ given by the composite
\[
\xymatrix@C=1.2cm{
PD \ar[r]^{P(f^{-1})} & PC \ar[r]^{\sup_C} & C \ar[r]^f & D \, , }
\]
 where $f^{-1} \co D \to C$ is the quasi-inverse of $f \co C \to D$. In particular, for $W = (\W x \co A) B(x)$, if we have an equivalence  
 $f \co W \to D$, then the induced $P$-algebra structure $\sup_D \co PD \to D$ defined as above is such that $D$ also satisfies 
 a form of the elimination rule for $W$-types.  We shall see that $D$ satisfies the other rules as well, but with weakened computation rule.




\begin{definition}\label{def:Wind}
We say that a $P$-algebra $C$  is \emph{inductive} if every fibered $P$-algebra
over it has a $P$-algebra section, \ie the type
\[ 
\isalgind(C) \defeq (\Pi E \co \FibPalg(C)) \,  \PalgSec(C,E) 
\]  
is inhabited.
\end{definition}

As before, for a $P$-algebra $C$, the type $\isalgind(C)$ is a mere proposition. The next proposition characterises
inductive $P$-algebras by means of deduction rules.

\begin{proposition} \label{thm:palgindrec}
Let $C = (C, \sup_C)$ be a $P$-algebra. Then $C$ is inductive if and only if it satisfies the following rules:

\smallskip

\begin{enumerate}[(i)]
\item the elimination rule, 
\[
\begin{prooftree}
\begin{array}{c}
z \co C \vdash E(z) \co \U \\ 
\textstyle
x \co A \, , u  \co B(x) \to C,\, v \co (\Pi y \co B(x))  E(u y) \vdash e(x,u,v) \co E(\sup_C(x,u))
\end{array}
\justifies
z \co C \vdash \elim(z,e) \co E(z)
\end{prooftree}
\]

\bigskip

\item the computation rule,
\[
\begin{prooftree}
\begin{array}{c}
z \co C \vdash E(z) \co \U \\ 
\textstyle
x \co A ,\, u \co  B(x) \to C ,\, v \co (\Pi y \co B(x))  E(uy) \vdash e(x,u,v) \co E(\sup_C(x,u))
\end{array}
\justifies
x \co A,\, u \co B(x) \to C
   \vdash 
   \comp(x,u,e) \co
    \Id \big( \elim(\sup_C(x,u),e),  e(x,u, (\lambda y \co B(x)) \elim(u y, e)) \big)
\end{prooftree}
\]
\end{enumerate}
\end{proposition}

\medskip

We begin by showing that being implies the essential uniqueness of $P$-sections of fibered $P$-types. 


\begin{proposition} \label{lem:Wetaind}
Let $C = (C, \sup_C)$ be a $P$-algebra. If $C$ is inductive, then it satisfies the following further rules:


\begin{enumerate}[(i)]
\item the $\eta$-rule, 
\[
\begin{prooftree}
\begin{array}{c} 
 z \co C \vdash E(z) \co \U   \\ 
 \textstyle x \co A,\,    u \co B(x) \to C,\, e \co (\Pi y \co B(x)) E(uy ) \vdash e(x,u,v) \co E(\sup_C(x,u))  \\  
  z \co C \vdash f(z) \co E(z) \\ 
 x \co A \, ,  u \co B(x) \to C \vdash \bar{f}(x,u) \co \Id  \big(  f(\sup_C(x,u)) ,  e\big(x,u, f \circ u ) \big) 
 \end{array}
 \justifies
z \co C \vdash \eta_z \co \Id( f(z),  \elim(z,e))
\end{prooftree}
\]

\bigskip

\item the coherence rule,
\[
\begin{prooftree}
\begin{array}{c}
z \co C \vdash E(z) \co \U   \\ 
\textstyle x \co A,\,    u \co B(x) \to C,\, v \co (\Pi y \co B(x))E(uy) \vdash e(x,u,v) \co E(\sup_C(x,u))  \\  
 z \co C \vdash f(z) \co E(z) \\ 
x \co A \, ,  u \co B(x) \to C \vdash \bar{f}(x,u) \co \Id  \big(  f(\sup_C(x,u)) ,  e\big(x,u, f \circ u ) \big) 
\end{array}
\justifies
x \co A, u \co B(x) \to C \vdash \bar{\eta}_{(x,u)} \co
\Id\big( \eta_{\sup_C(x,u)} \ct \comp(x,u), \; 
\bar{f}(x,u)\cdot e(x,u,\int(\eta\circ u)) \big)
\end{prooftree}
\]

\end{enumerate}

\end{proposition}


\begin{proof} For $z \co C$, let us define $F(z) \defeq \Id \big(   f(z), \ind(z,e))$. With this notation, proving
 the propositional $\eta$-rule amounts to defining $\eta(z) \co F(z)$, for $z \co C$. In order to do so, we apply
the elimination rule for $C$. Thus, we need to show that, for $x \co A$, $u \co B(x) \to C$ and~$\alpha \co 
(\Pi y \co B(x)) F(uy)$, there 
is 
\[
q(x,y,\alpha) \co   F(\sup_C(x,u)) \, .
\]
We can construct this path explicitly as follows:
\begin{align*}
f(\sup_C(x,u)) &\iso s_E\big(x,u , f \circ u \big)   \by{\bar{f}(x,y)}\\
	&\iso e\big(x,u, (\lambda y \co B(x) )\, \ind(u y ,e) \big) \by{e(x,y,\int(\alpha))}\\
	& \iso \ind(\sup_C(x,u),e) \by{\comp(x,y)^{-1}}.
\end{align*}
For $z \co C$, we can then define
\[
\eta(z) \defeq \ind(z,q) \co F(z) \, ,
\] 
For $x \co A$ and $u \co B(x) \to C$, the  computation rule of Proposition~\ref{thm:palgindrec} then gives us
\[
 \eta_{\sup_C(x,u)} \iso  \bar{f}(x,u) \cdot e(x,y,\int(  \eta \circ u ))  \cdot  \comp(x,y)^{-1} \, .
\]
The path required to prove  the coherence rule is then obtained using the groupoid laws.
\end{proof}


\subsection{Homotopy-initial algebras}
Exactly as in the case of bipointed types, the hypothesis that a $P$-algebra $C$ is inductive allows us to show that for any
$P$-algebra $D$, there is a $P$-algebra morphism $f \co C \to D$ which is unique up to a $P$-algebra path, itself is unique up 
to a higher path, which in turn is unique up to a yet higher path, etc... As before, we shall characterise this kind of universal property
using the notion of a homotopy-initial $P$-algebra, which we define next.

\begin{definition}\label{def:AlgInit}
Let $C = (C, \sup_C)$ be a $P$-algebra. We say that $C$ is  \emph{homotopy-initial}  if for any $P$-algebra 
$D = (D, \sup_D)$, the type $\Palg(C,D)$ of $P$-algebra morphisms from $C$ to $D$
is contractible, \ie the following type is inhabilited
\[
\isalghinit(C) \defeq
 (\Pi D \co \Palg)  \, \iscontr \big( \Palg(C,D) \big)  \, .
\]  
\end{definition}

We stress again that homotopy-initiality is a purely type-theoretic notion. Also note that, exactly as for 
homotopy-initiality of bipointed types, for a $P$-algebra $C$, the type
$\isalghinit(C)$ is a mere proposition. 
We have the following type-theoretic analogue of Lambek's lemma.


\begin{lemma}\label{lem:IntLambek} Let $C = (C, \sup_C)$ be a $P$-algebra. 
If $C$ is homotopy-initial, then the structure map $\sup_C \co PC \to C$ is an equivalence.
\end{lemma}


\begin{proof} This is a straightforward translation of the standand category-theoretic proof, but we provide
some details to illustrate where the contractibility condition in the definition of a homotopy-initial algebra is
used. For brevity, let us write $s \co PC \to C$ for the structure map of $C$. 

 We wish to construct a quasi-inverse to $s \co PC \to C$. In order to do so, we use the homotopy-initiality
of $C$. First of all, observe that $PC$ can be made into a $P$-algebra by considering the structure map 
$Ps \co PPC \to PC$. Thus, by the contractibility of the type $\Palg(C, PC)$, there exists a $P$-algebra
morphism $(t, \bar{t}) \co C \to PC$. We represent it as the diagram
\begin{equation}
\label{equ:bart}
\xycenter{
PC \ar[d]_{s} \ar[r]^{Pt} \ar@{}[dr]|{\bar{t}}& PPC \ar[d]^{Ps} \\
C \ar[r]_{t} & PC}
\end{equation}
Now, the composite $s \circ t \co C \to C$ and the identity $1_C \co C \to C$ are both $P$-algebra
morphisms and so, by the contractibility of $\Palg(C,C)$, there has to be a path $p \co \Id(s\circ t ,1_C)$. 
Using this fact, we can also show that there is a path $q \co \Id(t \circ s, 1_{PC})$. Indeed, we have
\[
t \circ s  \iso Ps \circ Pt 
 \iso P(s \circ t) 
 \iso P(1_C) 
  \iso 1_{PC} \, ,
\]
where the first path is given by $\bar{t}$ in~\eqref{equ:bart}, the second is given by the pseudo-functoriality of $P$,
the third is the path $p$ constructed above, and the fourth one is given again by the pseudo-functoriality of $P$. 
\end{proof}







\begin{proposition} \label{thm:recursiveW}
A $P$-algebra $C = (C, \sup_C)$  is  homotopy-initial if and only if it satisfies the following rules:

\medskip

\begin{enumerate}[(i)]
\item the recursion rule,
\[
\begin{prooftree}
D \co \U \qquad 
x \co A \, ,  y \co B(x) \to D \vdash \sup_D(x,y) \co D 
\justifies
z \co C \vdash \rec(z,\sup_D) \co D
\end{prooftree}
\]
\item the $\beta$-rule,
\[
\begin{prooftree}
D \co \U \qquad 
x \co A \, ,  y \co B(x) \to D \vdash \sup_D(x,y) \co D 
\justifies
x \co A,\, u \co B(x) \to D \vdash
 \beta(x,u ,\sup_D) \co \Id \big( \rec(\sup_C(x,u),\sup_D) \, ,  \sup_D\big(x, (\lambda y \co B(x)) \,  \rec(u y, \sup_D)\big) \big)
\end{prooftree}
\]

\item the $\eta$-rule,
 \smallskip
\[
\begin{prooftree}
\begin{array}{c}
 D \co \U \\ 
x \co A,\, u \co B(x) \to D  \vdash  \sup_D(x,u) \co D \\ 
z \co C  \vdash f(z) \co D \\ 
x \co A, u \co B(x) \to D  \vdash  \bar{f}(x,u) \co \Id( f(\sup_C(x,y)),  \sup_D(x , u \circ f )) 
\end{array}
\justifies
z  \co A \vdash \eta_z \co \Id( f(z) , \rec(z,\sup_D))
\end{prooftree}
\]

\item the $(\beta, \eta)$-compatibility rule, 
\[
\begin{prooftree}
\begin{array}{c}
D \co \U  \\ 
x \co A,\, u \co B(x) \to D \vdash \sup_D(x,u)  \co D \\ 
 z \co C \vdash f(z) \co D \\ 
x \co A, u \co B(x) \to D \vdash \bar{f}(x,u) \co \Id( f(\sup_C(x,u)) , \sup_D(x, f \circ u ))
\end{array}
\justifies
x \co A, u \co B(x) \to C \vdash 
\bar{\eta}(x,u) \co \Id( \eta_{\wsup(x,u)} \ct \beta(x,u,\sup_D), 
\bar{f}(x,u) \ct \sup_D(x,\int(\eta\circ u)))
\end{prooftree} \smallskip
\]
\end{enumerate}

\end{proposition}




\begin{proof} The rules can be read as follows. The recursion rule says that, given any type $D$ together 
with the function $\sup_D \co PD \to D$, \ie any $P$-algebra, there is a function $r \co C \to D$
defined by letting,  for $z \co C$, 
\[
r(z) = \rec(z, \sup_D) \, .
\]
The $\beta$-rule implies that we have a homotopy 
\[
\beta \co \Hot( r \circ \sup_C \, , \sup_D \circ Pr)
\]
and so, by Proposition~\ref{lem:fibhomeqid}, we get a path $\bar{r}$ fitting in the diagram
\[
\xymatrix{
PC \ar[d]_{\sup_C} \ar[r]^{Pr} \ar@{}[dr]|{\bar{r}} & PD \ar[d]^{\sup_D} \\
C \ar[r]_r & D}
\]
We therefore obtain a $P$-algebra morphism  $(r, \bar{r}) \co C \to D$.  The 
$\eta$-rule says that if $f \co C \to D$ is a $P$-algebra morphism, then there is a homotopy $\eta \co f \sim r$.  
And the $(\beta,\eta)$-compatibility rule says that $\eta$ is in fact a $P$-algebra homotopy. Using again 
Proposition~\ref{lem:fibhomeqid}, this shows that there is a path from $(r, \bar{r})$ to $(f, \bar{f})$, thus
proving the contractibility of $\Palg(C,D)$.
\end{proof}



We can now state and prove our main result. 

\begin{theorem}\label{thm:WMain} A $P$-algebra is inductive if and only if
it is homotopy-initial, \ie the type
\[ 
(\Pi C \co \Palg) \big( \isalgind(C) \leftrightarrow \isalghinit(C) \big)
\]
is inhabited. 
\end{theorem}





\begin{proof}
Let $C = (C, \sup_C)$ be an inductive $P$-algebra; we wish to show that it is homotopy initial.
For this, it suffices to observe that the rules in Proposition~\ref{thm:recursiveW} are a special case of those given in Proposition~\ref{thm:palgindrec} and Proposition~\ref{lem:Wetaind}.

To show that $C = (C, \sup_C)$ is inductive if it is homotopy-initial, we proceed as in the proof of
Theorem~\ref{thm:bipointedmain}. We write simply $\sup \co PC \to C$ for brevity.
Thus let $E = (E, e)$ be a fibered algebra over $C$. We need to show that there
exists a $P$-algebra section $(s, \bar{s})$, where $s \co (\Pi x \co C) E(x)$ and 
\[ 
\bar{s} \co (\Pi x \co A)(\Pi u \co B(x) \to C) \Id \big( s(\sup(x,u)), e(x, u, s u) \big)
\]
We now consider the $P$-algebra $(E', \sup_{E'})$ associated to $E$, where $E' \defeq
(\Sigma z \co C) E(z)$ and $\sup_{E'} \co PE' \to E'$ is defined so that, for $x \co A$ and $u \co B(x) \to E'$, 
we have
\[
\sup_{E'}(x,u) = \big( \sup_C(x,\pi_1  u) \, , e (x,\pi_1  u, \pi_2  u )\big) \co E' \, .
\]
In this way, the first projection $\pi_1 \co E' \to C$  is an algebra morphism, represented by the diagram
\[
\xymatrix{
PE' \ar[d]_{\sup_{E'}}  \ar[r]^{P\pi_1} \ar@{}[dr]|{\Downarrow \overline{\pi}_1} & PC \ar[d]^{\sup}  \\
E' \ar[r]_{\pi_1} & C \, .}
\]
By the homotopy-initiality of $C$, there exists an algebra morphism $(f, \bar{f}) \co (C, \sup)  \to (E', \sup_{E'})$,
which we represent with the diagram
\[
\xymatrix{
PC \ar[r]^{Pf} \ar[d]_-{\sup_{C}} \ar@{}[rd]|{\Downarrow \, \bar{f}} & PE' \ar[d]^{\sup_{E'}} \\ 
C  \ar[r]_-{f} & E' \, .}
 \]
%
Composing $f \co C \to E'$ with $\pi_1 \co E' \to C$ we obtain a $P$-algebra morphism $f_1 \co C \to C$, represented by the diagram
\[
\xymatrix{
PC \ar[r]^{Pf_1} \ar[d]_-{\sup_{C}} \ar@{}[rd]|{\Downarrow \, \overline{f}_1} & PC \ar[d]^{\sup_{C}} \\ 
C  \ar[r]_-{f_1} & C \, .}
 \]
Unfolding the definitions, we have that, for $x \co A,  u \co B(x) \to C$, 
\[
(\overline{f_1})_{x,u} =   \pi_1( \ext^\Sigma(\bar{f}_{x,u})) \co \Id(  
\sup(x, f_1 u) \, , f_1 \, \sup(x,u)   ) \, .
\] 
By the homotopy-initiality of $C$ and Lemma~\ref{IdEqHo}, there exists a $P$-algebra 
homotopy 
\[
(\alpha, \bar{\alpha}) \co \AlgHot(f_1 , 1_C) \, ,
\]
where  $\alpha \co \Hot( f_1 , 1_C)$ and, for $x \co A$, $u \co B(x) \to C$, the path
$\bar{\alpha}_{x,u}$ fits into the diagram
\begin{equation}
\label{equ:alphabar}
{\vcenter{\hbox{\xymatrix@C=2cm{
\sup(x, f_1 u) \ar[r]^{(\bar{f}_1)_{x,u}} \ar[d]_{\sup(x, \int(\alpha_u))}  
\ar@{}[dr]|{\Downarrow \, \bar{\alpha}_{x,u}} & f_1 \sup(x,u) \ar[d]^{\alpha_{\sup(x,u)}} \\ 
\sup(x,u) \ar[r]_{\bar{1}_{x,u}} & \sup(x,u) \, . }}}}
\end{equation}
Here, $\int(\alpha_u )\co \Id( f_1  u \, ,  u)$ is the path associated to the homotopy
$(\lambda y \co B(x)) \alpha_{u y} \co \Hot( f_1 u y, u y)$. 
We define the required section $s \co (\Pi z \co C) E(z)$ so that, for $z \co C$ we have
\begin{equation*}
s(z) \defeq (\alpha_z)_{!} \big(  f_2 z \big) \, ,
\end{equation*}
where  $(\alpha_z)_{!} : E(f_1 z) \to E(z)$ is the transport map associated to the path
$\alpha_z \co \Id( f_1 z,  z)$. It now remains to  define, for each $x \co A$ and $u \co B(x)\to C$, 
a path
\[
\bar{s}(x,u) \co \Id\big(  e_s(x,u) \, , s(\sup(x,u)) \big) \, .
\] 
Unfolding the definitions, we see that our goal is to show that
\begin{equation}\label{eq:proof:thm:WMain:needpath}
e(x, u, (\lambda y \co B(x)) (\alpha_{u y})_{!} ( f_2 u y)   )  \iso
(\alpha_{\sup(x,u)})_{!} (  f_2 \, \sup(x,u) )  \, .
\end{equation}
Our goal will follow once we show the following:
\begin{align*}
\textit{Claim 1.} &  \qquad  e\big(x, u, (\lambda y \co B(x)) (\alpha_{uy})_{!}(f_2 u y) \big) \iso
(\sup(x, \int(\alpha_u)))_{!} \, e(x, f_1 u, f_2 u) \, . \\
\textit{Claim 2.} &  \qquad  e(x,  f_1 u, f_2 u) \iso ((\overline{f}_1)_{x,u})^* (f_2 \, \sup(x,u))   \, . \\ 
\textit{Claim 3.} &  \qquad  \sup(x, \int(\alpha_u)) \iso
\alpha_{\sup(x,u)}  \ct (\overline{f}_1)_{x,u}  
\end{align*}
Inded, the required path in~\eqref{eq:proof:thm:WMain:needpath} can then be obtained as follows:
 \begin{alignat*}{2} 
 e(x, u, (\lambda y \co B(x)) (\alpha_{uy})_{!}( f_2 u y)) 
 &  \iso  (\sup(x, \int(\alpha_u)))_{!} \;   e(x, f_1 u, f_2 u)  & \quad  & \text{(by Claim 1)}  \\
 & \iso    (\sup(x, \int(\alpha_u)))_{!} \;  ((\overline{f}_1)_{x,u})^*  (f_2 \, \sup(x,u) )  & \quad &  \text{(by Claim 2)}\\
 & \iso   (\alpha_{\sup(x,u)})_{!} ( f_2 \, \sup(x,u) )   & \quad & \text{(by Claim 3).} 
  \end{alignat*} 
We conclude the proving the auxiliary claims stated above.

\begin{proof}[Proof of claim 1] 

Observe that for all $a \co A$, $p \co \Id_{B(a) \to C}(t_1, t_2)$  and 
$v \co (\Pi y \co B(a))E(t_1y)$, we have
\[ 
e \big( a, t_2,  (\lambda y \co B(a)) ( \ext(p)_y )_{!}\, v y \big) \big)  \iso
(\sup(a,p))_{!}\, e(a,t_1,v) \, . 
\]
by $\Id$-elimination. If we apply this to $x \co A$, $\int(\alpha_u) \co \Id( f_1 u, u)$, and $f_2 u \co
(\Pi y \co B(x)) E(f_1 u y)$, we get
\[
e\big(x, u , (\lambda y \co B(x)) \big( (\alpha_{u y} \big)_{!} \;  f_2 u y  \big) \big) 
\iso
\big( \sup(x,\int(\alpha_u)) \big)_{!} \; e(x, f_1 u , f_2 u)  \, ,
\]
as required. \noqed
\end{proof}  

\begin{proof}[Proof of Claim 2] Recall that the path making $f \co C \to E'$ into a $P$-algebra morphism has the
 form
 \[
( \overline{f})_{x,u} \co \Id \big( \sup_{E'}(x, fu) \, , f  \,  \sup(x,u) \big)
\]
and thus by the characterization of paths in $\Sigma$-types, we have a path 
\[
 (\overline{f}_1)_{x,u}  \co \Id \big( \sup(x, f_1 u) \, , f_1 \, \sup(x,u) \big)
 \] 
 and a path
 \[
  e(x, f_1 u, f_2 u) \iso  ( (\overline{f}_1)_{x,u} )^* ( f_2 \, \sup(x,u) )
 \]
\noqed
\end{proof}
 
\begin{proof}[Proof of Claim 3.]  This follows by the diagram in~\eqref{equ:alphabar}. 
\end{proof}  \noqed
\end{proof}


\begin{remark} By Theorem~\ref{thm:WMain}, for every $P$-algebra $C = (C, \sup_C)$ there is actually an equivalence $\isalgind(C) \simeq \isalghinit(C)$ since both types are mere propositions.  
\end{remark}

For the next corollary, we work in the type theory $\Hint + \W$, obtained by adding to $\Hint$ the rules for $W$-types.
We consider again~$A \co \U$ and $B \co A \to \U$ and let~$W \defeq (\W x \co A) B(x)$.

\begin{corollary}[$\Hint + \W$]
\label{lem:WInitInt} Let $C = (C, \sup_C)$ be a $P$-algebra. The following conditions are
equivalent:
\begin{enumerate}[(i)]
\item $C$ is inductive,
\item $C$ is homotopy initial,
\item $C$ is equivalent to $W$ as a $P$-algebra.
\end{enumerate}
In particular, the type $W$ is a homotopy-initial $P$-algebra.
\end{corollary}


Corollary~\ref{lem:WInitInt} provides the analogue in our setting of the characterization of W-types as a strict initial algebra in extensional type theory. It makes precise the informal idea that, in intensional type theory, W-types are a kind of initial algebra in the weak $(\infty, 1)$-category of types, functions, paths, higher paths, \ldots.  

\begin{lemma}[$\Hint + \W$]\label{lem:suppath}
For all $a_1,a_2 \co A$, $t_1 \co B(x_1) \to W$, $t_2 \co B(x_2) \to W$, there is an equivalence of types
\[ 
\Id ( \wsup(a_1,t_1),  \wsup(a_2,t_2)  ) \simeq  \Id \big( (a_1,t_1), (a_2,t_2) \big) \, . 
\]
\end{lemma}

\begin{proof}
By Lemma~\ref{lem:IntLambek} and Corollary~\ref{lem:WInitInt}, $\sup_W \co PW \to W$ is an equivalence.
\end{proof}





We  remark that $W$-types  preserve homotopy levels, in the following sense.

\begin{theorem}[$\Hint + \W$]
If $A$ is an $(n+1)$-type, then so is $(\W x \co A) B(x)$.
\end{theorem}


\begin{proof}
We need to show that $\Id(w, w')$ is an $n$-type for all $w, w' \co W$. We do so applying the elimination for W-types.
So, let $x \co A, u \co B(x) \to W$ and assume the induction hypothesis 
\begin{itemize}
\item[$(\ast)$] for every $y \co B(x)$, $w' \co W$, the type $\Id( uy ,w')$ is an $n$-type, 
\end{itemize}
and show that  the type $\Id(\sup_W(x,u), w')$ is an $n$-type for all $w' \co W$. We apply again the elimination rule for W-types. So, let   $x' \co A$, $u' \co B(x') \to W$ and assume the induction hypothesis, which we do not spell out since we will not need it, and show that $\Id( \sup_W(x,u) , \sup_W(x',u'))$ is an $n$-type. We have
\begin{align*} 
\Id(\sup_W(x,u), \sup_W(x',u'))
& \simeq \Id((x,u) , (x',u')) \\
& \simeq (\Sigma p \co \Id(x, u')) \Id( u , p_{!} \, u' )   \\
& \simeq (\Sigma p \co \Id(x,x'))  \Id\big(u , \lambda y. \,  u'( p_{!} y)\big) \\
& \simeq (\Sigma p \co \Id(x,x')) (\Pi y \co B(x)) \Id \big( uy  , u'(p_{!} \, y)\big) \, , 
\end{align*}
Here, the first equivalence follows by Lemma~\ref{lem:suppath}. Since $A$ is an $(n+1)$-type by assumption, we have 
that~$\Id(a,a')$ is an $n$-type. Also, for any $p \co \Id(x,x')$ and $y \co B(x) \to W$, the type~$\Id(uy ,  u'(p_{!} \, y))$ is an $n$-type by the 
induction 
hypothesis in~$(\ast)$. The claim follows by recalling that $n$-types are closed under arbitrary dependent products and under dependent 
sums over $n$-types. 
\end{proof}

We note that there is no restriction on the homotopy level of the fibers of $B$ since they only appear contravariantly. Furthermore, we note that the lemma is no longer true if $n+1$ is replaced by $n$, as the following example
illustrates: if $A \defeq 1$ and $B(x) \defeq 1$, then $(\W x:A) B(x) \simeq 0$, which is not contractible. 


\subsection{Univalence for algebras} \label{sec:univalencealgebras}
We conclude this section with some applications of the Univalence Axiom. The first is that, just as for bipointed 
types, a form of univalence holds also for $P$-algebras, as the next theorem makes precise. 


\begin{theorem}[$\Hint + \UA$] \label{thm:Punivalence}
Let $C$ and $D$ be $P$-algebras. The canonical function
\[ 
\ext^\Palg_{C,D} \co \Id \big(C,D\big) \to  \AlgEquiv(C,D) 
\]
is an equivalence.
\end{theorem}

\begin{proof} 
Let $C = (C,\sup_C)$ and $D= (D,\sup_D)$ be $P$-algebras. By the characterization of paths in $\Sigma$-types, the path space 
$\Id \big( (C,\sup_C) ,  (D,\sup_D) \big)$ can be expressed as the type
\[
(\Sigma p \co \Id(C, D)) \Id \big( \sup_C ,  p_{!}(\sup_D)  \big) \, .
\]
By path induction on $p$ and the characterization of paths in $\Pi$-types, this type is equivalent to
\[  
(\Sigma p \co \Id(C,D))
(\Pi x \in A) 
(\Pi u \co B(x) \to W)
\Id \big(  \pi_1(\ext(p))( \sup_C(x,u)),  \sup_D(x, \pi_1(\ext (p)) \circ u) \big) \, , 
\]
where $\ext \co \Id(C,D) \to \mathsf{Equiv}(C,D)$ is the canonical function, asserted to be an equivalence by the Univalence Axiom. Since it is an equivalence, the above type is equivalent to
\[
(\Sigma f \co \mathsf{Equiv}(C,D)) 
(\Pi x  \co A) 
(\Pi y \co B(x) \to W) \, 
\Id \big( \pi_1(f) (\sup_C(x,u))  , \sup_D (x, \pi_1(f) \circ u) \big) \, .
\]
After rearranging we get
\[
(\Sigma f \co \Palg ( (C,\sup_C),  (D,\sup_D) ) \isequiv(\pi_1(f)) \, .
\]
By Lemma~\ref{WAlgSpace}, this type is equivalent to $\AlgEquiv \big( (C,\sup_C),  (D,\sup_D)\big)$, as desired. Finally, it is not hard to see that the composition of the above equivalences yields, up to a homotopy, the canonical function $\ext$ which is therefore an equivalence, as required.
\end{proof} 

The following corollary, still obtained under the assumption of the Univalence Axiom, shows that
homotopy-initial algebras are unique up to a unique path.

\begin{corollary}[$\Hint + \UA$] \label{WHInitIso}
Homotopy-initial $P$-algebras are unique up to a  contractible type of paths, i.e. the type
\[ 
(\Pi C \co \Palg) (\Pi D \co \Palg) \big( \isalghinit(C) \times \isalghinit(D)  \to 
\iscontr(\Id(C,D)) \big) \, .
\] 
is inhabited.
\end{corollary}

\begin{proof}
By Theorem~\ref{thm:Punivalence} it suffices to prove $\iscontr(\AlgEquiv(C,D))$. The type $\Palg(C,D)$ is contractible by homotopy-initiality of $C$. Since the dependent sum of a family of mere propositions over a mere proposition is again a mere proposition, it suffices to prove $\iscontr(\isalgequiv(f))$ for any $P$-algebra morphism $f$. This type is a mere proposition, as remarked earlier; thus it suffices to show it is inhabited.
Since $D$ is homotopy-initial, there exists a $P$-algebra morphism $g \co D \to C$. Again by homotopy-initiality of $C$ and 
$D$, we have $\Id(g \circ f, 1_C)$ and $\Id(f \circ g, 1_D)$, which gives us the desired $P$-algebra equivalence between 
$C$ and $D$.
\end{proof}



\section*{Acknowledgements}

We would like to thank Vladimir Voevodsky and Michael Warren for helpful discussions
on the subject of this paper. In particular, Vladimir Voevodsky suggested a simplification of the 
proof that the an inductive $P$-algebra is homotopy-initial.
 Steve Awodey gratefully acknowledges the support of the National Science Foundation, Grant DMS-1001191 and the Air Force OSR, Grant 11NL035. Nicola Gambino is grateful for the support of the Institute for Advanced Study, where
he worked on this project. This work was supported by the National Science Foundation 
under agreement No.\ DMS-0635607. Any opinions, findings and conclusions or recommendations
expressed in this material are those of the authors and do not necessarily reflect the views of
the National Science Foundation. Kristina Sojakova is grateful for the support of CyLab at Carnegie
Mellon under grants DAAD19-02-1-0389 and W911NF-09-1-0273 from the Army
Research Office.








\bibliographystyle{plain}

\bibliography{references}
                        


\end{document}